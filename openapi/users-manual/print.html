<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ThingsPro Edge - User&#x27;s Manual</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Overview</li><li class="chapter-item expanded "><a href="overview/what-is-TPE.html"><strong aria-hidden="true">1.</strong> What is ThingsPro Edge?</a></li><li class="chapter-item expanded "><a href="overview/what-is-TPP.html"><strong aria-hidden="true">2.</strong> What is ThingsPro Proxy?</a></li><li class="chapter-item expanded affix "><li class="part-title">Getting Started</li><li class="chapter-item expanded "><a href="quick_started/initial_configuration.html"><strong aria-hidden="true">3.</strong> Initial Configuration</a></li><li class="chapter-item expanded "><a href="quick_started/installation.html"><strong aria-hidden="true">4.</strong> Installation</a></li><li class="chapter-item expanded affix "><li class="part-title">Northbound Services</li><li class="chapter-item expanded "><a href="northbound/mqtt_client.html"><strong aria-hidden="true">5.</strong> MQTT Client</a></li><li class="chapter-item expanded "><a href="northbound/sparkplugB.html"><strong aria-hidden="true">6.</strong> Sparkplug B.</a></li><li class="chapter-item expanded "><a href="northbound/aid.html"><strong aria-hidden="true">7.</strong> Azure IoT Device</a></li><li class="chapter-item expanded "><a href="northbound/aie.html"><strong aria-hidden="true">8.</strong> Azure IoT Edge</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="northbound/azure-iotedge/ta.html"><strong aria-hidden="true">8.1.</strong> ThingsPro Agent</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="northbound/azure-iotedge/ta_twin.html"><strong aria-hidden="true">8.1.1.</strong> Module Twin</a></li><li class="chapter-item expanded "><a href="northbound/azure-iotedge/ta_command.html"><strong aria-hidden="true">8.1.2.</strong> Direct Method</a></li></ol></li><li class="chapter-item expanded "><a href="northbound/azure-iotedge/module.html"><strong aria-hidden="true">8.2.</strong> Module Development</a></li></ol></li><li class="chapter-item expanded "><a href="northbound/aws_iot_core.html"><strong aria-hidden="true">9.</strong> AWS IoT Core</a></li><li class="chapter-item expanded affix "><li class="part-title">Southbound Services</li><li class="chapter-item expanded "><a href="southbound_services/modbus.html"><strong aria-hidden="true">10.</strong> Modbus</a></li><li class="chapter-item expanded "><a href="southbound_services/opcua.html"><strong aria-hidden="true">11.</strong> OPC UA Server </a></li><li class="chapter-item expanded affix "><li class="part-title">Device Configuration</li><li class="chapter-item expanded "><a href="device_configuration/dashboard.html"><strong aria-hidden="true">12.</strong> Dashboard</a></li><li class="chapter-item expanded "><a href="device_configuration/general_settings.html"><strong aria-hidden="true">13.</strong> General Settings</a></li><li class="chapter-item expanded "><a href="device_configuration/system_settings.html"><strong aria-hidden="true">14.</strong> System Settings</a></li><li class="chapter-item expanded "><a href="device_configuration/import_export.html"><strong aria-hidden="true">15.</strong> Import/ Export</a></li><li class="chapter-item expanded "><a href="device_configuration/sys_event_logs.html"><strong aria-hidden="true">16.</strong> System/ Event Logs</a></li><li class="chapter-item expanded affix "><li class="part-title">Security</li><li class="chapter-item expanded "><a href="security/user_management.html"><strong aria-hidden="true">17.</strong> User Management</a></li><li class="chapter-item expanded "><a href="security/upgrade.html"><strong aria-hidden="true">18.</strong> Upgrade</a></li><li class="chapter-item expanded affix "><li class="part-title">Compatibility</li><li class="chapter-item expanded "><a href="compatibility/eligible_devices.html"><strong aria-hidden="true">19.</strong> Eligible Devices</a></li><li class="chapter-item expanded "><a href="compatibility/software_development.html"><strong aria-hidden="true">20.</strong> Software Development</a></li><li class="chapter-item expanded "><a href="compatibility/knowissues_limitations.html"><strong aria-hidden="true">21.</strong> Known Issue &amp; Limitations</a></li><li class="chapter-item expanded affix "><li class="part-title">Tech Notes</li><li class="chapter-item expanded "><a href="tech_notes/modbus_master.html"><strong aria-hidden="true">22.</strong> Modbus Master Specification</a></li><li class="chapter-item expanded "><a href="tech_notes/ota_software_upgrade.html"><strong aria-hidden="true">23.</strong> OTA Software Upgrade</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ThingsPro Edge - User&#x27;s Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-thingspro-edge"><a class="header" href="#what-is-thingspro-edge">What Is ThingsPro Edge?</a></h1>
<p><strong>ThingsPro Edge</strong> is an <strong>IIoT edge gateway software</strong> that runs on Moxa IIoT Gateways (Moxa's industrial-grade edge computers) enabling you to close the gap between sensors and cloud applications. The containerized software architecture of ThingsPro Edge brings an extensible runtime experience with secure and reliable life-cycle management to functional modules. </p>
<p><strong>ThingsPro Edge</strong> offers an easy-to-use user interface to: acquire data from sensors and other field devices, manipulate or filter data locally before sending it out to your applications, and secure data transmission during uploads to popular cloud platforms or your application/database. With the built-in RESTful API, integrating these capabilities into your system is more straightforward than ever.</p>
<h1 id="system-architecture"><a class="header" href="#system-architecture">System Architecture</a></h1>
<p>ThingsPro Edge can fit into your sensor-to-cloud IIoT solution and help simplify application design and development.</p>
<p><img src="overview/./assets/System_Architecture-1604259811619.png" alt="System_Architecture" /></p>
<h1 id="what-can-thingspro-edge-offer"><a class="header" href="#what-can-thingspro-edge-offer">What can ThingsPro Edge offer?</a></h1>
<p>ThingsPro Edge is designed to enable global IIoT businesses by offering them an integrated solution. The most challenging step in digital transformation of a business is connecting to the IT field without breaking the existing OT network. In association with system integrators (SIs) and independent software vendors (ISVs), Moxa can help enterprises conquer these complexities by offering a simplified, secure, and reliable OT data transportation solution. The following illustration shows how ThingsPro Edge works on top of the Moxa Edge computing platform to play an essential role in secure and robust <strong>Data Ingestion</strong>, <strong>Processing</strong>, and <strong>Transmission</strong>.</p>
<p><img src="overview/./assets/OT_Technology_Framework-1604253192904.png" alt="OT_Technology_Framework" /></p>
<ul>
<li><strong>Intuitive Web GUI</strong></li>
</ul>
<p>ThingsPro Edge is configured and managed using standard web technologies. You no longer need to use a command line interface to configure Modbus settings for device connections and Azure connection strings and certificates. You can use the intuitive web GUI to connect IIoT gateways and configure the network and system settings, create device tags, and monitor the runtime status, all from a computer on the network.</p>
<ul>
<li><strong>Integration With the Azure IoT Hub</strong></li>
</ul>
<p>In addition to managing Moxa's IIoT Gateways from ThingsPro Edge's Web GUI, you can now configure, monitor, and control these Gateways from the Azure portal. <u>ThingsPro Edge Device Service</u> integrates device twins, direct methods, and device-to-cloud messages into ThingsPro Edge to realize seamless remote monitoring and control from the cloud.</p>
<ul>
<li><strong>Streamlined Sensor-to-cloud Data Transportation</strong></li>
</ul>
<p>With ThingsPro Edge, transporting your data from the assets at the edge to your business has never been easier! If you are building a cloud application, Modbus and other OT-protocol applications help you acquire data from your edge devices. You can then use Azure or other cloud connectivity applications to publish the taged data to the cloud where you can build you applications. </p>
<ul>
<li><strong>Custom Payload</strong></li>
</ul>
<p>ThingsPro Edge makes it easy to publish acquired data to your applications and systems. You no longer require to develop programs to manipulate the message format to suit your applications or systems. ThingsPro Edge helps you manipulate data without requiring any programming skills.</p>
<ul>
<li><strong>Rapid Application Development</strong></li>
</ul>
<p>ThingsPro Edge is designed for rapid development so that you can quickly create software applications for autonomous data processing and event-triggered actions or alarms.</p>
<ul>
<li><strong>Secure Design</strong></li>
</ul>
<p>ThingsPro Edge helps you maintain the integrity of data during transmission and processing. The SecureBoot function and a built-in Trusted Platform Module (TPM) offer strong data protection for your device.</p>
<ul>
<li><strong>Robust OTA Upgrade</strong></li>
</ul>
<p>Keeping the software and firmware on your device up-to-date can effectively help prevent cyberattacks. However, updating devices located in remote unmanned sites is a big challenge for most administrators. ThingsPro Edge's robust over-the-air (OTA) updates cover both software application and device firmware upgrades. The resume capability ensures that you can get the upgrade pack even with intermittent cellular connectivity and the roll-back mechanism will enable your system to recover from a failed installation.</p>
<p>In a nutshell, the dual-track architecture represents the core values of ThingsPro Edge.</p>
<ul>
<li>The <strong>Data Vehicle</strong> component offers the capabilities to transport the OT data as per your requirement.</li>
<li>The <strong>Device Management</strong> component simplifies remote monitoring and control of your Moxa IIoT gateways.</li>
</ul>
<p><img src="overview/./assets/Dual_Track_Value.png" alt="Dual_Track_Value" /></p>
<h4 id="data-ingestion-processing-and-distribution"><a class="header" href="#data-ingestion-processing-and-distribution">Data Ingestion, Processing, and Distribution</a></h4>
<p>Due to the complex nature of OT-control networks, one of the biggest challenges is devising different methods to collect and process data from different types of assets at the edge. Using ThingsPro Edge, you can choose a Fieldbus protocol such as <u>Modbus</u> or set up your own way to handle data and leave the rest to the software. ThingsPro Edge can ingest the data and tag them for efficient processing. The built-in <strong>Cloud connectivity APP</strong> will help you distribute data to popular cloud platforms, where your applications or databases are located.</p>
<p><img src="overview/./assets/Data_Vehicle.png" alt="Data_Vehicle" /></p>
<h4 id="device-management"><a class="header" href="#device-management">Device Management</a></h4>
<p>Device configuration, in most cases, is a one-time effort. However, you may require troubleshooting issues in the system more often, especially during the development or PoC stage. ThingsPro Edge can help you take care of both PoC and production scenarios. The Moxa IIoT gateways are accessible on your network via the Web GUI and once they are deployed in the field, the device twin along with the ThingsPro Edge device service will help bridge the Moxa devices with the Azure portal for seamless configuration, monitoring and control.</p>
<p><img src="overview/./assets/Device_Management-1604253566980.png" alt="Device_Management" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-thingspro-proxy"><a class="header" href="#what-is-thingspro-proxy">What Is ThingsPro Proxy?</a></h1>
<p>A new Moxa IIoT gateway must be configured correctly before it can be deployed in the field. Moxa's ThingsPro Proxy utility helps you provision new devices in a secure and scalable manner.</p>
<p><strong>ThingsPro Proxy (TPP)</strong> is a Windows-based provisioning tool for batch configuring Moxa IIoT gateways based on specific plans. The provisioning plans include details such as device configuration, cloud enrollment information, and security settings. The ThingsPro Proxy plans allow field operators to quickly configure/enroll Moxa devices without requiring domain knowledge and without having to go through complex steps, thereby reducing the cost of operation. The device provisioning tasks can be linked to a configuration plan for quick and effortless provisioning.</p>
<p><img src="overview/./assets/TPP_Common_Scenario.png" alt="TPP_Common_Scenario" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="initial-configuration"><a class="header" href="#initial-configuration">Initial Configuration</a></h1>
<p>To get ThingsPro Edge up and running with the default settings, do the following:</p>
<p><strong>Note:</strong> We recommend using <u>Google Chrome</u> because ThingsPro Edge has been tested and verified on the browser. 
&gt;HTTPS only supports TLS 1.2 encryption; ensure that your browser support TLS 1.2.</p>
<ol>
<li>
<p>Launch ThingsPro Edge.</p>
<p><strong>Note:</strong> HTTP has been disabled by default to avoid security risks. The default HTTPS port is <strong>8443</strong> because Azure IoT Edge uses port 443 as its default.</p>
<p>a. Connect LAN 2 to the default IP 192.168.4.127 and enter <strong><code>https://192.168.4.127:8443</code></strong> in the address bar of the browser. 
Because the SSL certificate is self-signed by Moxa, you will see a warning message from the browser. </p>
<p><img src="quick_started/./assets/Insecure_private_connection-cert_authority_invalid-1604392122922.PNG" alt="Insecure_private_connection-cert_authority_invalid" /></p>
<p>b. Click on the <strong>Advanced</strong> button to proceed.
c. Click on the <strong><u>Proceed to 192.168.4.127 (unsafe)</u></strong> link to connect to ThingsPro Edge.</p>
<p><img src="quick_started/./assets/Insecure_private_connection-advanced-1604392132191.PNG" alt="Insecure_private_connection-advanced" /></p>
<p>You will see the ThingsPro Edge homepage.</p>
<p><img src="quick_started/./assets/Homepage-1604392138358.PNG" alt="Homepage" /></p>
</li>
<li>
<p>Login using the default Account &amp; Password.</p>
<p>Account: <strong><code>admin</code></strong>
Password: <strong><code>admin@123</code></strong></p>
<p><img src="quick_started/./assets/default_account-1604392144326.PNG" alt="default_account" /></p>
<p><strong>Note:</strong> For security reasons, we suggest changing the default password after the first login.</p>
</li>
<li>
<p>Configure your system and start transmitting data.</p>
<ul>
<li><strong>Overview</strong>: Dashboard to monitor the system and network status</li>
<li><strong>System Configuration</strong>: All system and device configuration settings</li>
<li><strong>Protocol</strong>: Modbus connections settings</li>
<li><strong>Cloud Connectivity</strong>: Data transmission and remote management settings to connect your IIoT gateway to the cloud</li>
<li><strong>Security</strong>: User access control and role management to restrict access to this IIoT Gateway</li>
<li><strong>Maintenance</strong>: Operation and maintenance tasks such as reboot (the IIoT gateway), configuration import/export, and the main switch for system services and applications</li>
<li><strong>Diagnostic</strong>: Event logs to help you understand the events on the IIoT gateway and the system log to troubleshoot system issues or to send information to Moxa Technical Support.</li>
</ul>
<p><img src="quick_started/./assets/Homepage-1604263168228.PNG" alt="Homepage" /></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-thingspro-edge"><a class="header" href="#installing-thingspro-edge">Installing ThingsPro Edge</a></h1>
<h3 id="install-thingspro-edge-from-an-installer"><a class="header" href="#install-thingspro-edge-from-an-installer">Install ThingsPro Edge From an Installer</a></h3>
<p>Download the installer from the <a href="https://www.moxa.com/en/products/industrial-computing/system-software/thingspro-edge-series#resources">official website</a> and install the packages using the <code>dpkg</code> command using the <code>root</code> privilege.</p>
<pre><code class="language-shell">root@Moxa:~# dpkg -i moxa-thingspro-edge-*.deb
...
**********************************************************
* The installation process ended successfully.
**********************************************************
</code></pre>
<p>You can track the progress of the installation using <code>journalctl -u update -f</code>.</p>
<p>When you install ThingsPro Edge for the first time, you will have to wait a lot longer so that all the built-in APPs, such as the API service, are installed. You can query progress using:</p>
<pre><code class="language-shell">root@Moxa:~# appman app ls
+---------------+-------------+--------------------------------+---------+
|     NAME      |   VERSION   | STATE (DESIRED STATE)          | HEALTH  |
+---------------+-------------+--------------------------------+---------+
| cloud         | 2.1.0-1013  | ready (ready)                  | good    |
| device        | 2.1.0-3528  | ready (ready)                  | good    |
| edge-web      | 1.9.17-5046 | ready (ready)                  | good    |
| modbusmaster  | 1.3.2-602   | installing (ready) - importing | running |
|               |             | images...0% (3/4)              |         |
| tagservice    | 2.1.0-575   | ready (ready)                  | good    |
+---------------+-------------+--------------------------------+---------+
</code></pre>
<h3 id="install-thingspro-edge-via-thingspro-proxy"><a class="header" href="#install-thingspro-edge-via-thingspro-proxy">Install ThingsPro Edge via ThingsPro Proxy</a></h3>
<p>Find the ThingsPro Proxy (TPP) Utility on the <a href="https://www.moxa.com/en/products/industrial-computing/system-software/thingspro-edge-series#resources">official website</a> and install ThingPro Edge using a provisioning plan.</p>
<h4 id="creating-a-provisioning-plan"><a class="header" href="#creating-a-provisioning-plan">Creating a Provisioning Plan</a></h4>
<ol>
<li>In ThingsPro Proxy, click on the <strong>Create Provisioning Plan</strong> link.</li>
<li>Specify a target device model and click <strong>START</strong>.
Select <strong>Non-Specific Model</strong> or <strong>Specific Model</strong>.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_1.png" alt="img" /></p>
<ol start="3">
<li>Specify the ThingsPro Edge (TPE) installation settings and click <strong>NEXT</strong>.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_2.png" alt="img" /></p>
<ol start="4">
<li>(optional) Specify other settings in the provisioning plan as required.</li>
<li>In the <strong>Summary</strong>, specify a plan name, assign a password, and click <strong>CREATE</strong>.<br />
The password is used to encrypt the plan and then decrypt it before importing the plan.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_3.png" alt="img" /></p>
<ol start="6">
<li>Click <strong>DOWNLOAD &amp; FINISH</strong> to download the plan. 
The plan will be downloaded as a *.zip file.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_4.png" alt="img" /></p>
<ol start="7">
<li>Click on the <strong>Provisioning</strong> link.</li>
<li>Choose the type of provisioning <strong>Targeted Provisioning</strong> or <strong>On-air Provisioning</strong> and click <strong>SCAN</strong>.</li>
<li>Select devices to discover or press <strong>SCAN</strong> to re-scan the LAN for devices and click <strong>NEXT</strong>.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_5.png" alt="img" /></p>
<ol start="11">
<li>Press <strong>BROWSE...</strong> to select a plan, enter the associated password, and click <strong>NEXT</strong>.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_6.png" alt="img" /></p>
<ol start="12">
<li>Click <strong>APPLY</strong>.</li>
</ol>
<p><img src="quick_started/./assets/TPP_Installation_7.png" alt="img" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mqtt-client"><a class="header" href="#mqtt-client">MQTT Client</a></h1>
<p>Click MQTT Client, and you can add many connections to MQTT Broker.</p>
<p>Note that you need to create a connection first and select D2C telemetry messages to an MQTT broker. </p>
<p>To create an MQTT Client, following the steps below:</p>
<ol>
<li>Click <strong>ADD CONNECTION</strong>.</li>
<li>Specify a Server (default port: 8883).</li>
<li>Select an MQTT Version.</li>
<li>Enter Client ID, Username, and Password.</li>
<li>(Optional) Enable persistent session.</li>
<li>Select a way of message QoS, and retain function on/off.</li>
<li>(Optional) Enable SSL/TLC.</li>
<li>(Optional) Enable will flag.</li>
<li>(Optional) Select a way of message QoS and retain function for Will flag.</li>
</ol>
<p><img src="northbound/./assets/clip_image024-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image026-1604264036031.png" alt="img" /><img src="northbound/./assets/clip_image028-1604264036031.png" alt="img" /> </p>
<p>Once an MQTT Broker has been created, you can thus make a new telemetry message, following the steps below:</p>
<ol>
<li>Click <strong>+ MESSAGE</strong>.</li>
<li>Specify an output topic.</li>
<li>Enter a time for the polling interval.</li>
<li>Setup a threshold by size or a certain interval.</li>
<li>Click <strong>NEXT</strong>.</li>
<li>Select tags from provides (e.g., Modbus Master).</li>
<li>(Optional) Enable custom payload by using the jq filter.</li>
<li>Click <strong>SUBMIT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image030-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image032-1604264036031.png" alt="img" /> </p>
<p><strong>NOTE:</strong> The values shown in the <strong>Custom Payload Result</strong> are examples and not the real values.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sparkplug-b"><a class="header" href="#sparkplug-b">Sparkplug B</a></h1>
<p>Sparkplug B is a specification designed specifically for IoT applications so that MQTT devices and applications can send and receive messages in a stateful way. ThingsPro Edge provides an interface to enable and configure Sparkplug B communication.
The configuration process consissts of the following:</p>
<ul>
<li>Enabling Sparkplug</li>
<li>Configuring a Broker</li>
<li>Configuring a Telemety Message</li>
</ul>
<h2 id="enabling-sparkplug"><a class="header" href="#enabling-sparkplug">Enabling Sparkplug</a></h2>
<ol>
<li>Click on the <strong>Sparkplug B.</strong> link and use the scroll bar to enable Sparkplug B.</li>
<li>Specify an Edge Node ID.</li>
<li>Specify a Group ID.</li>
<li>(optional) Specify a Primary Host ID.</li>
<li>Click <strong>SUBMIT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image038.png" alt="img" /> </p>
<h2 id="configuring-a-broker"><a class="header" href="#configuring-a-broker">Configuring a Broker</a></h2>
<ol>
<li>Click on the <strong>+ CREATE</strong> link to create a broker for Sparkplug B.</li>
<li>Specify a <strong>Server</strong> (default port: 8883).</li>
<li>(optional) Enter <strong>Client ID</strong>, <strong>Username</strong>, and <strong>Password</strong>.</li>
<li>(optional) <strong>Enable SSL/TLS</strong> and upload <strong>Client Certificate</strong>, <strong>Key</strong>, and <strong>Trusted Root CA</strong>.</li>
<li>Click <strong>SUBMIT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image034.png" alt="img" /><img src="northbound/./assets/clip_image036.png" alt="img" /></p>
<h2 id="configuring-a-telemetry-message"><a class="header" href="#configuring-a-telemetry-message">Configuring a Telemetry Message</a></h2>
<ol>
<li>Click on the <strong>+ MESSAGE</strong> link.</li>
<li>Select tags from providers (e.g., Modbus Master).</li>
<li>Select devices or system tags.</li>
<li>Click <strong>NEXT</strong>.
<img src="northbound/./assets/clip_image040.png" alt="img" /></li>
<li>Select a publish mode.</li>
<li>Select sampling mode.</li>
<li>Click <strong>NEXT</strong>.
<img src="northbound/./assets/clip_image042.png" alt="img" /></li>
<li>(optional) Specify a description.</li>
<li>Click <strong>SUBMIT</strong>.
<img src="northbound/./assets/clip_image044.png" alt="img" /></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="azure-iot-device"><a class="header" href="#azure-iot-device">Azure IoT Device</a></h1>
<p>Click Azure IoT Edge. You can enable/ disable the Azure IoT Edge. </p>
<p>Note that you will need to register an AWS account to be able to manage the AWS IoT Core service for your IoT application. </p>
<p>To create the Azure IoT Device connectivity, following the steps below: </p>
<ol>
<li>Click <img src="northbound/./assets/clip_image018-1604264036031.png" alt="img" /> to set connection.</li>
<li>Enter Connection String.</li>
<li>Select a connection protocol.</li>
<li>Select an authentication Type.</li>
<li>(Optional) Upload X.509 Certificate and Private Key.</li>
<li>Click <strong>SUBMIT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image020-1604264036031.png" alt="img" /> </p>
<h2 id="telemetry-message"><a class="header" href="#telemetry-message">Telemetry Message</a></h2>
<p>The simplest message type for sending IoT device data to your IIoT applications is a telemetry message. To create a telemetry message, do the following:</p>
<ol>
<li>In the <strong>CLOUD CONNECTIVITY</strong> section, select a cloud service provider.</li>
<li>Click on the <strong>Telemetry Message</strong> tab.</li>
<li>Specify an <strong>Output Topic</strong> name.</li>
<li>Enter the <strong>Polling Interval</strong> in seconds.</li>
<li>Setup a threshold by file size (bytes) or time interval (seconds).</li>
<li>Click <strong>NEXT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image002-1604264036031.png" alt="img" />
7. Select tags from provides (e.g., Modbus Master).<br />
8. (Optional) Enable custom payload by using the jq filter.<br />
9. Click <strong>NEXT</strong>.<br />
10. (Optional) Enter Property Key and Value.<br />
11. Click <strong>SUBMIT</strong>.</p>
<p><img src="northbound/./assets/clip_image004-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image006-1604264036031.png" alt="img" /> 
Device-to-Cloud (D2C) message policy allows you to transform default payload to your desired payload schema via the jq filter. For additional information, refer to the jq website (https://stedolan.github.io/jq/manual/).</p>
<h2 id="store-and-forward"><a class="header" href="#store-and-forward">Store and Forward</a></h2>
<p>D2C messages can be cached in a specified location and sent to the cloud later. This feature will help you to keep the acquired data in a queue temporarily when the network between your IIoT Gateway and the cloud is disconnected and transmit them to its destination after the reconnection. To enable the function, click on the <strong>Store and Forward</strong> and select <strong>Enable Store and Forward</strong>. You can select a target disk and set a maximum storage cache, set a retention policy, and a TTL (Time to Live) value for the messages.</p>
<p><img src="northbound/./assets/clip_image008-1604264036031.png" alt="img" /> </p>
<h2 id="device-management-1"><a class="header" href="#device-management-1">Device Management</a></h2>
<p>Enabling this feature allows cloud service providers manage IoT devices remotely by creating a Device Twin.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="azure-iot-edge"><a class="header" href="#azure-iot-edge">Azure IoT Edge</a></h1>
<p>Click Azure IoT Edge. You can enable/ disable the Azure IoT Edge. You can enroll the device via manual setting or DPS (Device Provisioning Service).</p>
<p>Note that you will need to register an Azure account to manage the Azure IoT Edge service for your IoT application.</p>
<p>To create Azure IoT Edge connectivity manually, following the steps below:</p>
<ol>
<li>Enable Azure IoT Edge.</li>
<li>Select <strong>Manual</strong>.</li>
<li>Enter <strong>Device Connection String</strong> (created by Azure IoT Device).</li>
<li>Click <strong>SUBMIT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image012-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image014-1604264036031.png" alt="img" /></p>
<p>To create Azure IoT Edge connectivity via DPS, following the steps below:</p>
<ol>
<li>Enable Azure IoT Edge.</li>
<li>Select <strong>DPS</strong>.</li>
<li>Select <strong>TPM</strong> or <strong>Symmetric encryption</strong> (depends on what your device registered in Azure IoT Device).</li>
<li>Enter Registration ID and Symmetric Key, if needed.</li>
<li>Click <strong>SUBMIT</strong></li>
</ol>
<p><img src="northbound/./assets/clip_image016-1604264036031.png" alt="img" /></p>
<p>If you want to check Azure IoT Edge configurations, click Azure IoT Edge &gt; AIE Checks and click <strong>CHECK.</strong> ThingsPro Edge checks the configurations and provides a result. More information about AIE Checks: https://github.com/Azure/iotedge/blob/master/doc/troubleshoot-checks.md </p>
<blockquote>
<p>We recommend fixing the edgeAgent and edgeHub modules to version 1.0.10.3 from the Azure IoT Hub when using Azure IoT Edge on ThingsPro Edge V2.2.0.</p>
</blockquote>
<h2 id="telemetry-message-1"><a class="header" href="#telemetry-message-1">Telemetry Message</a></h2>
<p>The simplest message type for sending IoT device data to your IIoT applications is a telemetry message. To create a telemetry message, do the following:</p>
<ol>
<li>In the <strong>CLOUD CONNECTIVITY</strong> section, select a cloud service provider.</li>
<li>Click on the <strong>Telemetry Message</strong> tab.</li>
<li>Specify an <strong>Output Topic</strong> name.</li>
<li>Enter the <strong>Polling Interval</strong> in seconds.</li>
<li>Setup a threshold by file size (bytes) or time interval (seconds).</li>
<li>Click <strong>NEXT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image002-1604264036031.png" alt="img" />
7. Select tags from provides (e.g., Modbus Master).<br />
8. (Optional) Enable custom payload by using the jq filter.<br />
9. Click <strong>NEXT</strong>.<br />
10. (Optional) Enter Property Key and Value.<br />
11. Click <strong>SUBMIT</strong>.</p>
<p><img src="northbound/./assets/clip_image004-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image006-1604264036031.png" alt="img" /> 
Device-to-Cloud (D2C) message policy allows you to transform default payload to your desired payload schema via the jq filter. For additional information, refer to the jq website (https://stedolan.github.io/jq/manual/).</p>
<h2 id="store-and-forward-1"><a class="header" href="#store-and-forward-1">Store and Forward</a></h2>
<p>D2C messages can be cached in a specified location and sent to the cloud later. This feature will help you to keep the acquired data in a queue temporarily when the network between your IIoT Gateway and the cloud is disconnected and transmit them to its destination after the reconnection. To enable the function, click on the <strong>Store and Forward</strong> and select <strong>Enable Store and Forward</strong>. You can select a target disk and set a maximum storage cache, set a retention policy, and a TTL (Time to Live) value for the messages.</p>
<p><img src="northbound/./assets/clip_image008-1604264036031.png" alt="img" /> </p>
<h2 id="device-management-2"><a class="header" href="#device-management-2">Device Management</a></h2>
<p>Enabling this feature allows cloud service providers manage IoT devices remotely throughout Device Twin and Direct Method technology.</p>
<h2 id="downstream-certificate-available-only-for-azure-iot-edge"><a class="header" href="#downstream-certificate-available-only-for-azure-iot-edge">Downstream Certificate (available only for Azure IoT Edge)</a></h2>
<p>To prevent your device from connecting to potentially malicious gateways (Azure IoT Edge inside), you can upload an <strong>X.509 certificate, Private Key</strong> and <strong>Trusted CA Certificate</strong>. These certificates can be generated via ThingsPro Edge in addition to your private certificate.</p>
<p><img src="northbound/./assets/clip_image010-1604264036031.png" alt="img" /> </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="thingspro-agent"><a class="header" href="#thingspro-agent">ThingsPro Agent</a></h1>
<p>ThingsPro Agent is a <font color='blue'><b>module</b></font> running on Azure IoT Edge, which bridge couple important functions between ThingsPro Edge and Azure IoT Edge seamless. This document describes the detail technical specification those you shall know, when deal with ThingsPro Agent.</p>
<p><img src="northbound/azure-iotedge/./asserts/module.png" alt="img" /></p>
<h3 id="install-module-thingspro-agent-on-thingspro-edge"><a class="header" href="#install-module-thingspro-agent-on-thingspro-edge">Install Module ThingsPro Agent on ThingsPro Edge</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/zh-tw/azure/iot-edge/how-to-register-device">Create iotedge device</a></li>
<li>Setup ThingsPro Agent (Add module from Azure Portal)
<ul>
<li>docker image:
<ul>
<li><code>moxa2019/thingspro-agent:2.1.1-amd64</code></li>
<li><code>moxa2019/thingspro-agent:2.1.1-armhf</code></li>
</ul>
</li>
<li>Container Create Option
<pre><code>{
  &quot;HostConfig&quot;: {
    &quot;Binds&quot;: [
        &quot;/var/thingspro/apps/cloud/data/setting/:/var/thingspro/cloudsetting/&quot;,
        &quot;/run/:/host/run/&quot;,
        &quot;/var/thingspro/data/:/var/thingspro/data/&quot;
    ]
  }
}
</code></pre>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="module-twin---reported-properties"><a class="header" href="#module-twin---reported-properties">Module Twin - Reported Properties</a></h2>
<p>Thingspro Agent exposes device's up to date configurations by reported properties when it connected. The reported properties be categorize by below.</p>
<h4 id="sections-of-reported-properties"><a class="header" href="#sections-of-reported-properties">Sections of Reported Properties</a></h4>
<table><thead><tr><th>No</th><th>Section</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>applications</td><td>List all installed applications on ThingsPro Edge.</td></tr>
<tr><td>2</td><td>httpserver</td><td>Display HTTP Server setting, and status.</td></tr>
<tr><td>3</td><td>sshserver</td><td>Display SSH Server setting, and status.</td></tr>
<tr><td>4</td><td>discovery</td><td>Show discovery service status: enable / disable.</td></tr>
<tr><td>5</td><td>serialconsole</td><td>Show serial console status: enable / disable.</td></tr>
<tr><td>6</td><td>wan</td><td>Display network interface which connect to WAN.</td></tr>
<tr><td>7</td><td>route</td><td>List routing priority for each network interface.</td></tr>
<tr><td>8</td><td>dhcpservers</td><td>List DHCP Server status and configuration.</td></tr>
<tr><td>9</td><td>serials</td><td>List serial port configuration.</td></tr>
<tr><td>10</td><td>time</td><td>Display system time zone and NTP setting.</td></tr>
<tr><td>11</td><td>ethernets</td><td>List Ethernet interface status and configuration.</td></tr>
<tr><td>12</td><td>general</td><td>List device general properties, such as CPU type, Firmware version, ThingsPro Edge version and etc.</td></tr>
<tr><td>13</td><td>gps</td><td>Display GPS setting.</td></tr>
<tr><td>14</td><td>installations</td><td>Display OTA upgrade progress and result.</td></tr>
<tr><td>15</td><td>wifi</td><td>Display wifi setting.</td></tr>
<tr><td>16</td><td>cellulars</td><td>List cellular interface status and configuration.</td></tr>
</tbody></table>
<h4 id="sample-of-reported-properties"><a class="header" href="#sample-of-reported-properties">Sample of Reported Properties</a></h4>
<pre><code>{
    &quot;applications&quot;: {
        &quot;list&quot;: {            
            &quot;0&quot;: {
                &quot;description&quot;: &quot;MOXA Modbus TCP Client (Master)&quot;,
                &quot;desiredState&quot;: &quot;ready&quot;,
                &quot;displayName&quot;: &quot;Modbus TCP Client (Master)&quot;,
                &quot;hardwares&quot;: {
                    &quot;arraySize&quot;: 0
                },
                &quot;health&quot;: &quot;good&quot;,
                &quot;icon&quot;: &quot;/app-icons/modbusmaster-tcp.png&quot;,
                &quot;id&quot;: &quot;modbusmaster-tcp&quot;,
                &quot;name&quot;: &quot;modbusmaster-tcp&quot;,
                &quot;state&quot;: &quot;ready&quot;,
                &quot;version&quot;: &quot;3.14.0-278&quot;
            },
            &quot;arraySize&quot;: 1
        }
    },
    &quot;httpserver&quot;: {
        &quot;certFileName&quot;: &quot;default.crt&quot;,
        &quot;httpEnable&quot;: true,
        &quot;httpPort&quot;: 80,
        &quot;httpsEnable&quot;: true,
        &quot;httpsPort&quot;: 8443,
        &quot;keyFileName&quot;: &quot;default.key&quot;
    },
    &quot;sshserver&quot;: {
        &quot;enable&quot;: true,
        &quot;port&quot;: 22
    },
    &quot;discovery&quot;: {
        &quot;enable&quot;: true
    },
    &quot;serialconsole&quot;: {
        &quot;enable&quot;: true
    },
    &quot;wan&quot;: {
        &quot;displayName&quot;: &quot;LAN1&quot;,
        &quot;dns&quot;: {
            &quot;0&quot;: &quot;10.128.8.5&quot;,
            &quot;arraySize&quot;: 1
        },
        &quot;gateway&quot;: &quot;10.144.51.254&quot;,
        &quot;ip&quot;: &quot;10.144.48.128&quot;,
        &quot;name&quot;: &quot;eth0&quot;,
        &quot;netmask&quot;: &quot;255.255.252.0&quot;,
        &quot;type&quot;: &quot;wan&quot;
    },
    &quot;route&quot;: {
        &quot;priorityList&quot;: {
            &quot;0&quot;: &quot;Cellular1&quot;,
            &quot;1&quot;: &quot;LAN1&quot;,
            &quot;arraySize&quot;: 2
        },
        &quot;type&quot;: &quot;route&quot;
    },
    &quot;dhcpservers&quot;: {
        &quot;0&quot;: {
            &quot;available&quot;: false,
            &quot;displayName&quot;: &quot;LAN1&quot;,
            &quot;domainName&quot;: &quot;&quot;,
            &quot;domainNameServers&quot;: {
                &quot;0&quot;: &quot;8.8.8.8&quot;,
                &quot;1&quot;: &quot;8.8.4.4&quot;,
                &quot;arraySize&quot;: 2
            },
            &quot;enable&quot;: false,
            &quot;endIp&quot;: &quot;192.168.3.250&quot;,
            &quot;id&quot;: 1,
            &quot;leaseTime&quot;: 3600,
            &quot;name&quot;: &quot;eth0&quot;,
            &quot;netmask&quot;: &quot;255.255.255.0&quot;,
            &quot;startIp&quot;: &quot;192.168.3.200&quot;,
            &quot;status&quot;: false,
            &quot;type&quot;: &quot;dhcpservers&quot;
        },
        &quot;arraySize&quot;: 1
    },
    &quot;serials&quot;: {
        &quot;0&quot;: {
            &quot;baudRate&quot;: 9600,
            &quot;dataBits&quot;: 8,
            &quot;device&quot;: &quot;/dev/ttyM0&quot;,
            &quot;displayName&quot;: &quot;PORT 1&quot;,
            &quot;flowControl&quot;: &quot;none&quot;,
            &quot;id&quot;: 1,
            &quot;mode&quot;: &quot;rs232&quot;,
            &quot;parity&quot;: &quot;none&quot;,
            &quot;stopBits&quot;: 1,
            &quot;type&quot;: &quot;serials&quot;
        },
        &quot;arraySize&quot;: 1
    },
    &quot;time&quot;: {
        &quot;ntp&quot;: {
            &quot;enable&quot;: false,
            &quot;interval&quot;: 7200,
            &quot;server&quot;: &quot;pool.ntp.org&quot;
        },
        &quot;timezone&quot;: &quot;Asia/Taipei&quot;,
        &quot;type&quot;: &quot;time&quot;
    },
    &quot;general&quot;: {
        &quot;cpu&quot;: &quot;ARMv7 Processor rev 2 (v7l)&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;deviceType&quot;: &quot;gateway&quot;,
        &quot;firmwareVersion&quot;: &quot;3.0&quot;,
        &quot;hostName&quot;: &quot;Moxa&quot;,
        &quot;lastBootTime&quot;: &quot;2019-11-13T11:42:51Z&quot;,
        &quot;lastRebootTime&quot;: &quot;&quot;,
        &quot;memorySize&quot;: 524333056,
        &quot;modelName&quot;: &quot;UC-8112-LX&quot;,        
        &quot;serialNumber&quot;: &quot;TAIAB1021075&quot;,
        &quot;thingsproVersion&quot;: &quot;1.1.0-348&quot;,
        &quot;type&quot;: &quot;general&quot;
    },
    &quot;ethernets&quot;: {
        &quot;0&quot;: {
            &quot;broadcast&quot;: &quot;10.144.51.255&quot;,
            &quot;displayName&quot;: &quot;LAN1&quot;,
            &quot;dns&quot;: {
                &quot;0&quot;: &quot;10.128.8.5&quot;,
                &quot;arraySize&quot;: 1
            },
            &quot;enable&quot;: true,
            &quot;enableDhcp&quot;: false,
            &quot;gateway&quot;: &quot;10.144.51.254&quot;,
            &quot;id&quot;: 1,
            &quot;ip&quot;: &quot;10.144.48.128&quot;,
            &quot;mac&quot;: &quot;00:90:e8:77:06:61&quot;,
            &quot;name&quot;: &quot;eth0&quot;,
            &quot;netmask&quot;: &quot;255.255.252.0&quot;,
            &quot;status&quot;: &quot;connected&quot;,
            &quot;subnet&quot;: &quot;10.144.48.0&quot;,
            &quot;type&quot;: &quot;ethernets&quot;,
            &quot;wan&quot;: true
        },
        &quot;arraySize&quot;: 1
    },
    &quot;gps&quot;: {
        &quot;interface&quot;: &quot;&quot;,
        &quot;location&quot;: {
          &quot;lat&quot;: 14,
          &quot;lng&quot;: 15
        },
        &quot;mode&quot;: &quot;manual&quot;,
        &quot;type&quot;: &quot;gps&quot;
    },
    &quot;installations&quot;: {
        &quot;completedTask&quot;: 0,
        &quot;id&quot;: 3,
        &quot;isDeleted&quot;: false,
        &quot;jobID&quot;: 3,
        &quot;lastState&quot;: &quot;&quot;,
        &quot;owner&quot;: &quot;admin&quot;,
        &quot;parameter&quot;: {
          &quot;download&quot;: false,
          &quot;install&quot;: true,
          &quot;jobID&quot;: 2
        },
        &quot;state&quot;: &quot;created&quot;
    },
    &quot;wifi&quot;: {
        &quot;0&quot;: {
          &quot;ap&quot;: {
            &quot;band&quot;: &quot;band24&quot;,
            &quot;broadcastSsid&quot;: true,
            &quot;channel&quot;: 6,
            &quot;region&quot;: &quot;TW&quot;,
            &quot;security&quot;: {
              &quot;mode&quot;: &quot;wpa2&quot;,
              &quot;password&quot;: &quot;&quot;,
              &quot;encryption&quot;: &quot;aes&quot;
            },
            &quot;ssid&quot;: &quot;moxa-sample-ap&quot;
          },
          &quot;enable&quot;: true,
          &quot;id&quot;: 1,
          &quot;type&quot;: &quot;wifi&quot;,
          &quot;name&quot;: &quot;wlan0&quot;,
          &quot;mode&quot;: &quot;ap&quot;
        },
        &quot;arraySize&quot;: 1
    },
    &quot;cellulars&quot;: {
        &quot;0&quot;: {
          &quot;autoDetect&quot;: false,
          &quot;available&quot;: true,
          &quot;capabilities&quot;: {
            &quot;sim&quot;: 1
          },
          &quot;currentProfileId&quot;: 0,
          &quot;displayName&quot;: &quot;Cellular1&quot;,
          &quot;enable&quot;: false,
          &quot;iccid&quot;: &quot;&quot;,
          &quot;id&quot;: 1,
          &quot;imei&quot;: &quot;&quot;,
          &quot;imsi&quot;: &quot;&quot;,
          &quot;keepalive&quot;: {
            &quot;enable&quot;: false,
            &quot;intervalSec&quot;: 120,
            &quot;targetHost&quot;: &quot;8.8.8.8&quot;
          },
          &quot;mac&quot;: &quot;02:01:02:18:00:0b&quot;,
          &quot;module&quot;: &quot;u-blox TOBY-L2 series&quot;,
          &quot;name&quot;: &quot;usb0&quot;,
          &quot;operatorName&quot;: &quot;&quot;,
          &quot;pinRetryRemain&quot;: 0,
          &quot;profileTimeout&quot;: 140,
          &quot;profiles&quot;: {
            &quot;0&quot;: {
              &quot;id&quot;: 1,
              &quot;init&quot;: {
                &quot;0&quot;: &quot;sim:1&quot;,
                &quot;arraySize&quot;: 1
              },
              &quot;name&quot;: &quot;SIM1&quot;,
              &quot;pdpContext&quot;: {
                &quot;apn&quot;: &quot;internet&quot;,
                &quot;auth&quot;: {
                  &quot;password&quot;: &quot;&quot;,
                  &quot;protocol&quot;: &quot;none&quot;,
                  &quot;username&quot;: &quot;&quot;
                },
                &quot;id&quot;: 1,
                &quot;static&quot;: true,
                &quot;type&quot;: &quot;ipv4&quot;
              },
              &quot;pinCode&quot;: &quot;0000&quot;
            },
            &quot;arraySize&quot;: 1
          },
          &quot;rat&quot;: &quot;&quot;,
          &quot;status&quot;: &quot;disconnected&quot;,
          &quot;type&quot;: &quot;cellulars&quot;,
          &quot;wan&quot;: true
        },
        &quot;arraySize&quot;: 1
    }
}
</code></pre>
<h2 id="module-twin---desired-properties"><a class="header" href="#module-twin---desired-properties">Module Twin - Desired Properties</a></h2>
<p>ThingsPro Agent allow you to re-configure device and turn on/off services via Desired Properties. In current version, ThingsPro Agent allow below sections to be update via Desired Properties.</p>
<h4 id="sections-of-desired-properties"><a class="header" href="#sections-of-desired-properties">Sections of Desired Properties</a></h4>
<table><thead><tr><th>No</th><th>Section</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>httpserver</td><td>To enable/disable and change HTTP(s) port.</td></tr>
<tr><td>2</td><td>sshserver</td><td>To enable/disable and change SSH port.</td></tr>
<tr><td>3</td><td>discovery</td><td>To enable/disable device discovery service.</td></tr>
<tr><td>4</td><td>serialconsole</td><td>To enable/disable serial console port.</td></tr>
<tr><td>5</td><td>dhcpservers</td><td>To setup DHCP Server configuration.</td></tr>
<tr><td>6</td><td>serials</td><td>To setup serial port configuration.</td></tr>
<tr><td>7</td><td>time</td><td>To setup time zone, and enable/disable and setup NTP server.</td></tr>
<tr><td>8</td><td>ethernets</td><td>To setup Ethernet configuration.</td></tr>
<tr><td>9</td><td>general</td><td>To update host name and device description.</td></tr>
<tr><td>10</td><td>gps</td><td>To switch GPS mode to auto or manual.</td></tr>
<tr><td>11</td><td>wifi</td><td>To setup Wi-Fi AP configuration.</td></tr>
<tr><td>12</td><td>cellulars</td><td>To setup cellulars configuration.</td></tr>
</tbody></table>
<p><font color='red'><b>Note:</b></font></p>
<p>There are two keys that is commonly used in the desired properties:</p>
<ul>
<li><strong>id</strong>:
A device may own multiple interfaces of same kind resource, <strong>id</strong> specifies which interface is to be configured. <font><b>id</b></font> starts from <font color='blue'><b>0</b></font>.</li>
<li><strong>arraySize</strong>:
Azure device twin currently does not support array, so an array is encoded to a object containing children objects and an <strong>arraySize</strong> key. This value should match the number of children objects, else the remaining objects will be discarded.</li>
</ul>
<h4 id="1-https-server"><a class="header" href="#1-https-server">1. HTTP(s) Server</a></h4>
<ul>
<li>
<p>Update HTTP(s) Server configuration</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;httpserver&quot;: {
            &quot;httpEnable&quot;: true,
  	      &quot;httpPort&quot;: 80,
  	      &quot;httpsEnable&quot;: true,
  	      &quot;httpsPort&quot;: 8443
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="2-ssh-server"><a class="header" href="#2-ssh-server">2. SSH Server</a></h4>
<ul>
<li>
<p>Update SSH Server configuration</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;sshserver&quot;: {
            &quot;enable&quot;: true,
            &quot;port&quot;: 22
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="3-discovery-service"><a class="header" href="#3-discovery-service">3. Discovery Service</a></h4>
<ul>
<li>
<p>Update Discovery Service status</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;discovery&quot;: {
            &quot;enable&quot;: true
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="4-serial-console-port"><a class="header" href="#4-serial-console-port">4. Serial Console Port</a></h4>
<ul>
<li>
<p>Enable / Disable Serial Console Port</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;serialconsole&quot;: {
            &quot;enable&quot;: true
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="5-dhcp-server"><a class="header" href="#5-dhcp-server">5. DHCP Server</a></h4>
<ul>
<li>
<p>Update DHCP Server</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;dhcpservers&quot;: {
            &quot;0&quot;: {
                &quot;id&quot;: 1,
                &quot;enable&quot;: true,
                &quot;startIp&quot;: &quot;192.168.3.100&quot;,
                &quot;endIp&quot;: &quot;192.168.3.200&quot;,
                &quot;netmask&quot;: &quot;255.255.255.0&quot;,
                &quot;domainNameServers&quot;: {
                    &quot;0&quot;: &quot;8.8.8.8&quot;,
                    &quot;arraySize&quot;: 1
                },
                &quot;domainName&quot;: &quot;example.com&quot;,
                &quot;leaseTime&quot;: 2592000
            },
            &quot;arraySize&quot;: 1
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="6-serial-port"><a class="header" href="#6-serial-port">6. Serial Port</a></h4>
<ul>
<li>
<p>Update Serial Port to rs232</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;serials&quot;: {
            &quot;0&quot;: {
                &quot;id&quot;: 1,
                &quot;mode&quot;: &quot;rs232&quot;,
                &quot;displayName&quot;: &quot;PORT 1&quot;,
                &quot;baudRate&quot;: 115200,
                &quot;parity&quot;: &quot;none&quot;,
                &quot;dataBits&quot;: 8,
                &quot;stopBits&quot;: 1,
                &quot;flowControl&quot;: &quot;software&quot;
          },
            &quot;arraySize&quot;: 1
        }
    }
}
</code></pre>
</li>
</ul>
<p>​</p>
<table><thead><tr><th>No</th><th>Name</th><th>Available Values</th></tr></thead><tbody>
<tr><td>1</td><td>mode</td><td>rs232, rs422, rs4852w, rs4854w</td></tr>
<tr><td>2</td><td>baudRate</td><td>300, 600, 1200, 1800, 2400, 4800, 9600, 19200, 38400, 57600, 115200, 230400, 460800, 921600</td></tr>
<tr><td>3</td><td>parity</td><td>none, even, space, mark</td></tr>
<tr><td>4</td><td>dataBits</td><td>5,6,7,8</td></tr>
<tr><td>5</td><td>stopBits</td><td>1,2,1.5</td></tr>
<tr><td>6</td><td>flowControl</td><td>none, hardware, software</td></tr>
</tbody></table>
<h4 id="7-time-service"><a class="header" href="#7-time-service">7. Time Service</a></h4>
<ul>
<li>
<p>Update NTP Settings</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;time&quot;: {
            &quot;ntp&quot;: {
                &quot;enable&quot;: true,
                &quot;interval&quot;: 6000,
                &quot;server&quot;: &quot;tock.stdtime.gov.tw&quot;
            }
        }
    }
}
</code></pre>
</li>
<li>
<p>Update Time zone</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;time&quot;: {
            &quot;timezone&quot;: &quot;Asia/Taipei&quot;
        }
    }
}
</code></pre>
<p>引用Timezone list can be found at https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</p>
</li>
</ul>
<h4 id="8-ethernet"><a class="header" href="#8-ethernet">8. Ethernet</a></h4>
<ul>
<li>
<p>Update an Ethernet Interface to Dynamic IP</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;ethernets&quot;: {
            &quot;0&quot;: {
                &quot;id&quot;: 1,
                &quot;enable&quot;: true,
                &quot;enableDhcp&quot;: true,
                &quot;wan&quot;: true
            },
            &quot;arraySize&quot;: 1
        }
    }
}
</code></pre>
</li>
<li>
<p>Update an Ethernet Interface to Static IP</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;ethernets&quot;: {
            &quot;0&quot;: {
                &quot;id&quot;: 1,
                &quot;dns&quot;: {
                    &quot;0&quot;: &quot;1.2.3.4&quot;,
                    &quot;arraySize&quot;: 1
                },
                &quot;enable&quot;: true,
                &quot;enableDhcp&quot;: false,
                &quot;gateway&quot;: &quot;1.2.3.5&quot;,
                &quot;ip&quot;: &quot;1.2.3.6&quot;,
                &quot;netmask&quot;: &quot;255.255.255.0&quot;,
                &quot;wan&quot;: true
            },
            &quot;arraySize&quot;: 1
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="9-general"><a class="header" href="#9-general">9. General</a></h4>
<ul>
<li>
<p>Update device host name</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;general&quot;: {            
            &quot;hostName&quot;: &quot;MyHost&quot;
        }
    }
}
</code></pre>
</li>
<li>
<p>Update device description</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;general&quot;: {            
            &quot;description&quot;: &quot;MyDevice&quot;
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="10-gps"><a class="header" href="#10-gps">10. GPS</a></h4>
<ul>
<li>
<p>Update GPS lat, lng by manual mode</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;gps&quot;:{
            &quot;mode&quot;: &quot;manual&quot;,
            &quot;location&quot;: {
                &quot;lat&quot;: 11,
                &quot;lng&quot;: 12
            }
        }
    }
}
</code></pre>
</li>
<li>
<p>Update GPS by auto mode</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;gps&quot;:{
            &quot;mode&quot;: &quot;auto&quot;,
            &quot;interface&quot;: &quot;/dev/ttyUSB0&quot;
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="11-wi-fi"><a class="header" href="#11-wi-fi">11. Wi-Fi</a></h4>
<ul>
<li>
<p>Enable / Disable Wi-Fi AP mode</p>
<pre><code>{
    &quot;desired&quot;: {
        &quot;wifi&quot;: {
            &quot;0&quot;: {
                &quot;ap&quot;: {
                    &quot;band&quot;: &quot;band24&quot;,
                    &quot;broadcastSsid&quot;: true,
                    &quot;channel&quot;: 6,
                    &quot;region&quot;: &quot;TW&quot;,
                    &quot;security&quot;: {
                      &quot;mode&quot;: &quot;wpa2&quot;,
                      &quot;password&quot;: &quot;&quot;,
                      &quot;encryption&quot;: &quot;aes&quot;
                    },
                    &quot;ssid&quot;: &quot;moxa-sample-ap&quot;
                },
                &quot;enable&quot;: true,
                &quot;id&quot;: 1,
                &quot;type&quot;: &quot;wifi&quot;,
                &quot;name&quot;: &quot;wlan0&quot;,
                &quot;mode&quot;: &quot;ap&quot;
            },
            &quot;arraySize&quot;: 1
        }
    }
}
</code></pre>
</li>
</ul>
<h4 id="12-cellulars"><a class="header" href="#12-cellulars">12. Cellulars</a></h4>
<ul>
<li>Update cellular pin code
<pre><code>{
  &quot;desired&quot;: {
    &quot;cellulars&quot;: {
      &quot;0&quot;: {
        &quot;autoDetect&quot;: false,
        &quot;available&quot;: true,
        &quot;capabilities&quot;: {
          &quot;sim&quot;: 1
        },
        &quot;currentProfileId&quot;: 0,
        &quot;displayName&quot;: &quot;Cellular1&quot;,
        &quot;enable&quot;: false,
        &quot;iccid&quot;: &quot;&quot;,
        &quot;id&quot;: 1,
        &quot;imei&quot;: &quot;358503060483337&quot;,
        &quot;imsi&quot;: &quot;&quot;,
        &quot;keepalive&quot;: {
          &quot;enable&quot;: false,
          &quot;intervalSec&quot;: 120,
          &quot;targetHost&quot;: &quot;8.8.8.8&quot;
        },
        &quot;mac&quot;: &quot;02:01:02:18:00:0b&quot;,
        &quot;module&quot;: &quot;u-blox TOBY-L2 series&quot;,
        &quot;name&quot;: &quot;usb0&quot;,
        &quot;operatorName&quot;: &quot;&quot;,
        &quot;pinRetryRemain&quot;: 0,
        &quot;profileTimeout&quot;: 140,
        &quot;profiles&quot;: {
          &quot;0&quot;: {
            &quot;id&quot;: 1,
            &quot;init&quot;: {
              &quot;0&quot;: &quot;sim:1&quot;,
              &quot;arraySize&quot;: 1
            },
            &quot;name&quot;: &quot;SIM1&quot;,
            &quot;pdpContext&quot;: {
              &quot;apn&quot;: &quot;internet&quot;,
              &quot;auth&quot;: {
                &quot;password&quot;: &quot;&quot;,
                &quot;protocol&quot;: &quot;none&quot;,
                &quot;username&quot;: &quot;&quot;
              },
              &quot;id&quot;: 1,
              &quot;static&quot;: true,
              &quot;type&quot;: &quot;ipv4&quot;
            },
            &quot;pinCode&quot;: &quot;0000&quot;
          },
          &quot;arraySize&quot;: 1
        },
        &quot;rat&quot;: &quot;&quot;,
        &quot;signal&quot;: {
          &quot;csq&quot;: 0,
          &quot;ecio&quot;: 0,
          &quot;indicator&quot;: &quot;&quot;,
          &quot;level&quot;: 0,
          &quot;rat&quot;: &quot;&quot;,
          &quot;rscp&quot;: 0,
          &quot;rsrp&quot;: 0,
          &quot;rsrq&quot;: 0,
          &quot;rssi&quot;: 0,
          &quot;rxqual&quot;: 0
        },
        &quot;status&quot;: &quot;disconnected&quot;,
        &quot;type&quot;: &quot;cellulars&quot;,
        &quot;wan&quot;: true
      },
      &quot;arraySize&quot;: 1
    }
  }
}
</code></pre>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="support-commands-for-direct-methods"><a class="header" href="#support-commands-for-direct-methods">Support Commands for Direct Methods</a></h2>
<p>ThingsPro Agent offered below 6 direct methods. You can invoke them when device is on-line.</p>
<table><thead><tr><th>No</th><th>Method Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>thingspro-api-v1</td><td>An universal direct method, allow to invoke almost all Restful API of ThingsPro Edge.</td></tr>
<tr><td>2</td><td>system-reboot</td><td>A direct method to restart Moxa's device.</td></tr>
<tr><td>3</td><td>thingspro-applications-control</td><td>To control application run time on device.</td></tr>
<tr><td>4</td><td>thingspro-software-upgrade</td><td>To perform software upgrade over the air.</td></tr>
</tbody></table>
<h4 id="1-thingspro-agent-universal-method"><a class="header" href="#1-thingspro-agent-universal-method">1. ThingsPro Agent Universal Method</a></h4>
<p>An universal direct method, to invoke almost all Restful API on ThingsPro Edge device. You can get ThingsPro Edge Restful API document at <a href="https://thingspro-edge.moxa.online/">here</a>.</p>
<ul>
<li>
<p>Method Name: </p>
<pre><code>thingspro-api-v1
</code></pre>
</li>
<li>
<p>Request Payload: (Example to set SSH configuration)</p>
<pre><code>{
    &quot;path&quot;:&quot;/system/sshserver&quot;,
    &quot;method&quot;:&quot;PUT&quot;,
    &quot;headers&quot;:[],
    &quot;requestBody&quot;: {&quot;enable&quot;: true, &quot;port&quot;: 22}
}
</code></pre>
<table><thead><tr><th>No</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>path</td><td>ThingsPro Edge Restful API endpoint.</td></tr>
<tr><td>2</td><td>method</td><td>The method which associated with API endpoint.</td></tr>
<tr><td>3</td><td>headers</td><td>It shall always be application/json.</td></tr>
<tr><td>4</td><td>requestBody</td><td>The post data which required by API endpoint.</td></tr>
</tbody></table>
</li>
<li>
<p>Response:</p>
<pre><code class="language-json">{
    &quot;status&quot;:200,
    &quot;payload&quot;:{&quot;data&quot;:{&quot;enable&quot;:true,&quot;port&quot;:22}}
}
</code></pre>
</li>
<li>
<p>Example screen shot</p>
<p><img src="https://ThingsPro.azureedge.net/resource/document/thingspro-agent-guide/directMethod.jpg" alt="" /></p>
<p><font color='red'><b>Note :  Please change below time out parameters to prevent any exception.</b></font></p>
<ul>
<li>Connection Timeout with 30 seconds </li>
<li>Method Timeout with 60 seconds.</li>
</ul>
</li>
</ul>
<h4 id="2-restart-device"><a class="header" href="#2-restart-device">2. Restart Device	</a></h4>
<p>This command will trigger device to reboot immediately.</p>
<ul>
<li>
<p>Method Name: </p>
<pre><code>system-reboot
</code></pre>
</li>
<li>
<p>Request Payload: </p>
<pre><code>{}
</code></pre>
</li>
<li>
<p>Response:</p>
<pre><code class="language-json">{
    &quot;status&quot;: 200,
    &quot;payload&quot;: {
        &quot;data&quot;: &quot;rebooting&quot;
    }
}
</code></pre>
</li>
</ul>
<h4 id="3-control-application-runtime"><a class="header" href="#3-control-application-runtime">3. Control Application runtime</a></h4>
<p>This direct method offers you a quick way to start/stop/restart applications which running on ThingsPro Edge.</p>
<ul>
<li>
<p>Method Name:</p>
<pre><code>thingspro-applications-control
</code></pre>
</li>
<li>
<p>Request Payload:</p>
<pre><code>{
    &quot;appName&quot;: &quot;modbusmaster-tcp&quot;,
    &quot;command&quot;: &quot;stop&quot;
}
</code></pre>
<table><thead><tr><th>No</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>appName</td><td>The name of applications running and managed by ThingsPro Edge. You can get application list by ThingsPro Restful API.</td></tr>
<tr><td>2</td><td>command</td><td>Support commands:<br />    - start<br />    - stop<br />    - restart</td></tr>
</tbody></table>
</li>
<li>
<p>Response:</p>
<pre><code>{
    &quot;status&quot;: 200,
    &quot;payload&quot;: {
        &quot;data&quot;: &quot;&quot;
    }
}
</code></pre>
</li>
</ul>
<h4 id="4-software-upgrade"><a class="header" href="#4-software-upgrade">4. Software Upgrade</a></h4>
<p>This direct method allow you to download upgrade software over the air.</p>
<ul>
<li>
<p>Method Name:</p>
<pre><code>thingspro-software-upgrade
</code></pre>
</li>
<li>
<p>Example to trigger download and installation at one upgrade job</p>
<ul>
<li>Request Payload:</li>
</ul>
<pre><code>{
    &quot;downloadURL&quot;: &quot;http://xxx/edge/87/doc_0.1.0-87_armhf.yaml&quot;,
    &quot;runInstallation&quot;: true
}
</code></pre>
<table><thead><tr><th>No</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>downloadURL</td><td>The URL point to upgrade software location.</td></tr>
<tr><td>2</td><td>runInstallation</td><td>value <strong>true</strong> : The installation task will auto start after download task completed.</td></tr>
</tbody></table>
<ul>
<li>Response:</li>
</ul>
<pre><code>{
    &quot;status&quot;: 200,
    &quot;payload&quot;: {
        &quot;data&quot;: {
        	&quot;id&quot;: 1
        }
    }
}
</code></pre>
</li>
<li>
<p>Example to trigger a download software only upgrade job</p>
<ul>
<li>Request Payload: </li>
</ul>
<pre><code>{
    &quot;downloadURL&quot;: &quot;http://xxx/edge/87/doc_0.1.0-87_armhf.yaml&quot;,
    &quot;runInstallation&quot;: false
}
</code></pre>
<table><thead><tr><th>No</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>downloadURL</td><td>The URL point to upgrade software location.</td></tr>
<tr><td>2</td><td>runInstallation</td><td>value <font color='blue'><b>false</b></font> : The installation task doesn't start by default. You can invoke next direct method to launch it.</td></tr>
</tbody></table>
<ul>
<li>Response:</li>
</ul>
<pre><code>{
    &quot;status&quot;: 200,
    &quot;payload&quot;: {
        &quot;data&quot;: {
        	&quot;id&quot;: 2
        }
    }
}
</code></pre>
</li>
<li>
<p>Example to trigger an installation for a upgrade job id</p>
<ul>
<li>Request Payload:</li>
</ul>
<pre><code>{
    &quot;id&quot;: 2,
    &quot;runInstallation&quot;: true
}
</code></pre>
<table><thead><tr><th>No</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td>runInstallation</td><td>Value shall always be <font color='blue'><b>true</b></font> at this case.</td></tr>
<tr><td>2</td><td>id</td><td>The Id returned from previous direct method.</td></tr>
</tbody></table>
<ul>
<li>Response</li>
</ul>
<pre><code>{
    &quot;status&quot;: 200,
    &quot;payload&quot;: {
        &quot;data&quot;: {
        	&quot;id&quot;: 3
        }
    }
}
</code></pre>
</li>
</ul>
<p><font color='red'><b>Note: </b></font></p>
<ol>
<li>
<p><font color='red'><b>ThingsPro agent will send back upgrade progress and status via reported properties.</b></font></p>
<ul>
<li>
<p>Report download progress</p>
<p><img src="https://ThingsPro.azureedge.net/resource/document/thingspro-agent-guide/ota-download-properties-1.jpg" alt="" /></p>
</li>
<li>
<p>Download success</p>
<p><img src="https://ThingsPro.azureedge.net/resource/document/thingspro-agent-guide/ota-download-properties-2.jpg" alt="" /></p>
</li>
</ul>
</li>
<li>
<p><font color='red'><b>ThingsPro Edge allow only one active software upgrade job once.</b></font></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="develop-an-azure-iot-edge-module-in-thingspro-edge"><a class="header" href="#develop-an-azure-iot-edge-module-in-thingspro-edge">Develop An Azure IoT Edge module In ThingsPro Edge</a></h1>
<h3 id="iot-edge-module-azure-documents"><a class="header" href="#iot-edge-module-azure-documents">IoT Edge Module (Azure Documents)</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/zh-tw/azure/iot-edge/how-to-deploy-modules-portal?view=iotedge-2018-06">how to deploy modules from azure portal</a></li>
<li><a href="https://docs.microsoft.com/zh-tw/azure/iot-edge/module-development?view=iotedge-2018-06">module development</a></li>
</ul>
<h3 id="iot-edge-module-example"><a class="header" href="#iot-edge-module-example">IoT Edge Module Example</a></h3>
<ul>
<li>Here is an example for you to refer to develop a IoT Edge module to complete the requirements:
<ol>
<li>Obtain and modify device properties by module twin.</li>
<li>Upload ThingsPro tags data by D2C message.</li>
<li>Update tag value by direct method.</li>
</ol>
</li>
<li><a href="https://gitlab.com/moxa/ibg/software/platform/thingspro/thingspro-edge-documents/-/tree/edge-design/users-manual/src/northbound/azure-iotedge/supports/agent">soure code</a></li>
</ul>
<h4 id="preparation-before-use-the-example-module"><a class="header" href="#preparation-before-use-the-example-module">Preparation Before Use The Example Module</a></h4>
<ul>
<li>modbus tcp device setup
<blockquote>
<p>Here I setup modbus tcp master to get the switch value of the meter. 
<img src="northbound/azure-iotedge/./asserts/modbus_setup.png" alt="img" /></p>
</blockquote>
</li>
<li>Azure IoT Edge setup
<blockquote>
<p>Set up and make sure ThingsPro's Azure IoT Edge service is connected successfully.
<img src="northbound/azure-iotedge/./asserts/azure_setup.png" alt="img" /></p>
</blockquote>
</li>
<li>Setup the example module on your IoT Edge device
<blockquote>
<p>module name: test<br />
image URL: <code>moxa2019/thingspro-sample:0.0.3-amd64</code><br />
container create options: </p>
<pre><code>{
  &quot;HostConfig&quot;: {
    &quot;Binds&quot;: [
      &quot;/var/thingspro/data/:/var/thingspro/data/&quot;
    ]
  }
}
</code></pre>
</blockquote>
</li>
<li>After IoT Edge deployment is complete, you can see the test module on the ThingsPro's Azure IoT Edge service page
<blockquote>
<p><img src="northbound/azure-iotedge/./asserts/module_setup.png" alt="img" /></p>
</blockquote>
</li>
</ul>
<h4 id="how-to-use-the-example-module"><a class="header" href="#how-to-use-the-example-module">How To Use The Example Module</a></h4>
<ul>
<li>Obtain and modify device properties by module twin.
<blockquote>
<p>The example module supports modifying the configuration of device description.<br />
Fill in the desired properties and click save in the IoT Edge's module twin page.<br />
<img src="northbound/azure-iotedge/./asserts/desired1.png" alt="img" /></p>
<p>On the ThingsPro webpage, you can see that the property has been modified.
<img src="northbound/azure-iotedge/./asserts/desired2.png" alt="img" /></p>
</blockquote>
</li>
<li>Upload ThingsPro's tags data by D2C message. 
<blockquote>
<p>The example module supports modifying the configuration of ThingsPro tags upload.<br />
Fill in the desired properties and click save in the IoT Edge's module twin page.</p>
<pre><code>{
    &quot;uploadTags&quot;: [
        {
            &quot;providerName&quot;: &quot;modbus_tcp_master&quot;,
            &quot;moduleName&quot;: &quot;mydevice&quot;,
            &quot;tagName&quot;: &quot;power&quot;
        }
    ],
    &quot;uploadInterval&quot;: 5
}
</code></pre>
<p><img src="northbound/azure-iotedge/./asserts/d2c.png" alt="img" /></p>
<p>The message has been sent to the Azure IoTHub.<br />
Here I use the Azure IoTHub plugin on vscode to monitor D2C message.<br />
<img src="northbound/azure-iotedge/./asserts/d2c2.png" alt="img" /></p>
</blockquote>
</li>
<li>Update ThingsPro's tag value by direct method.
<blockquote>
<p>Commands supported by the example module:<br />
command name: <code>tagWrite</code><br />
command payload:</p>
<pre><code>{
    &quot;providerName&quot;: &quot;modbus_tcp_master&quot;,
    &quot;moduleName&quot;: &quot;mydevice&quot;,
    &quot;tagName&quot;: &quot;power_w&quot;,
    &quot;dataType&quot;: &quot;boolean&quot;,
    &quot;dataValue&quot;: true
}
</code></pre>
<p>Invoke module command in IoT Edge device's direct method page.
<img src="northbound/azure-iotedge/./asserts/cmd1.png" alt="img" />
You can monitor that the value of power is updated to <code>true</code>.
<img src="northbound/azure-iotedge/./asserts/cmd2.png" alt="img" /></p>
</blockquote>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aws-iot-core"><a class="header" href="#aws-iot-core">AWS IoT Core</a></h1>
<p>Click AWS IoT Core, and you can enable/ disable the AWS IoT Core. To create the AWS IoT Core connectivity, following the steps below: </p>
<ol>
<li>Click <img src="northbound/./assets/clip_image018-1604264036031.png" alt="img" /> to set connection.</li>
<li>Enter Host, Port (default: 8883).</li>
<li>Enter ThingID.</li>
<li>Select a way of message QoS.</li>
<li>Upload X.509 Certificate, Private Key, and (optional) Trusted Root CA.</li>
<li>Click <strong>SAVE</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image022-1604264036031.png" alt="img" /> </p>
<h2 id="telemetry-message-2"><a class="header" href="#telemetry-message-2">Telemetry Message</a></h2>
<p>The simplest message type for sending IoT device data to your IIoT applications is a telemetry message. To create a telemetry message, do the following:</p>
<ol>
<li>In the <strong>CLOUD CONNECTIVITY</strong> section, select a cloud service provider.</li>
<li>Click on the <strong>Telemetry Message</strong> tab.</li>
<li>Specify an <strong>Output Topic</strong> name.</li>
<li>Enter the <strong>Polling Interval</strong> in seconds.</li>
<li>Setup a threshold by file size (bytes) or time interval (seconds).</li>
<li>Click <strong>NEXT</strong>.</li>
</ol>
<p><img src="northbound/./assets/clip_image002-1604264036031.png" alt="img" />
7. Select tags from provides (e.g., Modbus Master).<br />
8. (Optional) Enable custom payload by using the jq filter.<br />
9. Click <strong>NEXT</strong>.<br />
10. (Optional) Enter Property Key and Value.<br />
11. Click <strong>SUBMIT</strong>.</p>
<p><img src="northbound/./assets/clip_image004-1604264036031.png" alt="img" /></p>
<p><img src="northbound/./assets/clip_image006-1604264036031.png" alt="img" /> 
Device-to-Cloud (D2C) message policy allows you to transform default payload to your desired payload schema via the jq filter. For additional information, refer to the jq website (https://stedolan.github.io/jq/manual/).</p>
<h2 id="store-and-forward-2"><a class="header" href="#store-and-forward-2">Store and Forward</a></h2>
<p>D2C messages can be cached in a specified location and sent to the cloud later. This feature will help you to keep the acquired data in a queue temporarily when the network between your IIoT Gateway and the cloud is disconnected and transmit them to its destination after the reconnection. To enable the function, click on the <strong>Store and Forward</strong> and select <strong>Enable Store and Forward</strong>. You can select a target disk and set a maximum storage cache, set a retention policy, and a TTL (Time to Live) value for the messages.</p>
<p><img src="northbound/./assets/clip_image008-1604264036031.png" alt="img" /> </p>
<h2 id="device-management-3"><a class="header" href="#device-management-3">Device Management</a></h2>
<p>Enabling this feature allows cloud service providers manage IoT devices remotely throughout Device Shadow and jobs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-ingestion-modbus-connections"><a class="header" href="#data-ingestion-modbus-connections">Data Ingestion: Modbus Connections</a></h1>
<p>Go to <strong>Modbus &gt; Modbus Master</strong> to view all the Modbus TCP and RTU/ASCII devices. In addition to setting up Modbus TCP and Modbus RTU devices, you can also enable/disable Device Fail Event and Command Fail Event of the Modbus Master services here. </p>
<p>To add a Modbus TCP device, do the following:</p>
<ol>
<li>
<p>In the Modbus TCP section, select the <strong>TCP</strong> option.</p>
</li>
<li>
<p>Click <strong>ADD DEVICE</strong>.
a. Specify the <strong>Device Name</strong>.
b. Enter the <strong>Slave IP</strong> address.
c. Specify the <strong>Slave Port</strong> and <strong>Slave ID</strong>.
d. Click <strong>NEXT</strong>.
<img src="southbound_services/./assets/clip_image002-1604263999686.png" alt="img" /></p>
</li>
<li>
<p>Click <strong>+ ADD COMMAND</strong>.</p>
</li>
<li>
<p>Select or specify the function and the corresponding settings.</p>
</li>
<li>
<p>Select the <strong>Tag Type</strong>.</p>
</li>
<li>
<p>Click <strong>DONE</strong>.</p>
</li>
<li>
<p>Click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Click <strong>DONE</strong> to save the settings.
<img src="southbound_services/./assets/clip_image004-1604263999686.png" alt="img" /></p>
<p><img src="southbound_services/./assets/clip_image006-1604263999686.png" alt="img" /></p>
<p><img src="southbound_services/./assets/clip_image008-1604263999686.png" alt="img" /> </p>
</li>
</ol>
<p>To configure a Modbus TCP interface, select the <strong>TCP</strong> option and then click <img src="southbound_services/./assets/clip_image010-1604263999686.png." alt="img" /> You can also specify <strong>Initial Delay</strong>, <strong>Maximum Retry</strong>, and <strong>Response Timeout (ms)</strong> values for the interface.</p>
<p><img src="southbound_services/./assets/clip_image012-1604263999686.png" alt="img" /> </p>
<p>To add a Modbus RTU device, do the following:</p>
<ol>
<li>
<p>In the Modbus RTU/ASCII section, click on the <strong>COM (RTU)</strong> button. </p>
</li>
<li>
<p>Click <strong>ADD DEVICE</strong>.
a. Specify the <strong>Device Name</strong> and <strong>Slave ID</strong>.
b. Click <strong>NEXT</strong>.
<img src="southbound_services/./assets/clip_image014-1604263999686.png" alt="img" /></p>
</li>
<li>
<p>Click <strong>+ ADD COMMAND</strong>.</p>
</li>
<li>
<p>Select or specify the function and the corresponding settings.</p>
</li>
<li>
<p>Click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Click <strong>DONE</strong> to save the settings.
<img src="southbound_services/./assets/clip_image016-1604263999686.png" alt="img" /></p>
<p><img src="southbound_services/./assets/clip_image018-1604263999686.png" alt="img" /></p>
<p><img src="southbound_services/./assets/clip_image020-1604263999686.png" alt="img" /> </p>
</li>
</ol>
<p>To configure Modbus RTU settings, select the <strong>RTU</strong> option and click <img src="southbound_services/./assets/clip_image021.png" alt="img" />. You can also specify <strong>Initial Delay (ms)</strong>, <strong>Maximum Retry</strong>, and <strong>Response Timeout (ms)</strong> values for the interface. To manually set the inter-frame delay and inter-character timeout, you can uncheck the items and specify a time (ms).</p>
<p><img src="southbound_services/./assets/clip_image023.png" alt="img" /></p>
<p><strong>Note</strong>: The inter-frame delay and inter-character timeout settings are only available for Modbus RTU.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="opc-ua-server"><a class="header" href="#opc-ua-server">OPC UA Server</a></h1>
<p>Go to <strong>OPC UA Server</strong> to configure the OPC UA Server. You can also enable/ disable system event of the OPC UA services here.</p>
<p>To enable the OPC UA Server, do the following:</p>
<ol>
<li>
<p>Click <strong>LAN</strong></p>
<ul>
<li>
<p>Click Connection <strong>EDIT</strong> to enable this server. The service default is enabled with port 4840.
<img src="southbound_services/./assets/OPCUA_server.png" alt="img" /></p>
</li>
<li>
<p>(Optional) Click Security <strong>EDIT</strong> to edit Policies, User Authentication and Certificates.
<img src="southbound_services/./assets/security.png" alt="img" /></p>
</li>
<li>
<p>(Optional) Click <strong>Manage Account Details</strong> to create new accounts. The default account/ password is <em><strong>admin</strong></em>/ <em><strong>moxa</strong></em>.
<img src="southbound_services/./assets/manage_account.png" alt="img" /></p>
</li>
<li>
<p>(Optional) Click <strong>Manage Certficate Details</strong> to download the server certificate or upload a client certificate.
<img src="southbound_services/./assets/download_server_cert.png" alt="img" />
<img src="southbound_services/./assets/upload_client_cert.png" alt="img" /></p>
</li>
<li>
<p>(Optional) Click <strong>Advacned</strong> &gt; <strong>EDIT</strong>. You can configure the settings of subscription.
<img src="southbound_services/./assets/edit_subscription.png" alt="img" /></p>
</li>
</ul>
</li>
<li>
<p>Click <strong>ADD TAGS</strong> and select providers and tags.
<img src="southbound_services/./assets/add_tags.png" alt="img" /></p>
</li>
<li>
<p>Click <strong>DONE</strong></p>
</li>
<li>
<p>Click <strong>GO TO APPLE SETTINGS</strong>.</p>
</li>
<li>
<p>Click <strong>APPLY</strong>.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dashboard"><a class="header" href="#dashboard">Dashboard</a></h1>
<h2 id="system-overview"><a class="header" href="#system-overview">System Overview</a></h2>
<p>The dashboard shows the system status of the device, including hardware information, running applications/processes, CPU/Memory, and storage usage.</p>
<p><img src="device_configuration/./assets/Overview_2.png" alt="Overview_2" /></p>
<p><strong>Editing User Profiles</strong></p>
<p>Click on the <strong>Administrator</strong> button on the upper-right corner of the Overview page. You can view your profile, change the password, and switch to the Dark Theme here. </p>
<p><img src="device_configuration/./assets/clip_image002.png" alt="img" /></p>
<h2 id="network-overview"><a class="header" href="#network-overview">Network Overview</a></h2>
<p>Displays information on the WAN and LAN interfaces and the network traffic passing through the interfaces.</p>
<p><strong>WAN</strong></p>
<p>Displays information on the data sent and received through the WAN interfaces. You can select the interface the you want to monitor. In addition, other details on the usage of the WAN interfaces is displayed on the page. The information is refreshed every 10 seconds.</p>
<p><img src="device_configuration/./assets/clip_image002-1604263888771.png" alt="img" /> </p>
<p><strong>LAN</strong></p>
<p>Information on the LAN interfaces is organized under the <strong>LAN</strong> tab and includes information on the usage of the interfaces and the traffic passing through them. </p>
<p><img src="device_configuration/./assets/clip_image004.png" alt="img" /> </p>
<p>To monitor the interfaces in real time, click “<img src="device_configuration/./assets/clip_image006.png" alt="img" />” to auto refresh the data every 10 seconds. </p>
<p><img src="device_configuration/./assets/clip_image008.png" alt="img" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general-settings"><a class="header" href="#general-settings">General Settings</a></h1>
<h2 id="configuring-the-serverhost-name"><a class="header" href="#configuring-the-serverhost-name">Configuring the Server/host Name</a></h2>
<p>Go to <strong>General Settings &gt; System</strong> to specify a new server/host name and enter a description for the device. </p>
<p><img src="device_configuration/./assets/clip_image002-1604263959074.png" alt="img" /> </p>
<h2 id="configuring-the-system-time"><a class="header" href="#configuring-the-system-time">Configuring the System Time</a></h2>
<p>Go to <strong>General Settings &gt; Time</strong> to select a time zone. Choose between the <strong>Manual</strong> or <strong>Auto</strong> option to update the system time.</p>
<p><img src="device_configuration/./assets/clip_image004-1604263959073.png" alt="img" /> </p>
<h2 id="configuring-gps"><a class="header" href="#configuring-gps">Configuring GPS</a></h2>
<p>Go to <strong>General Settings &gt; GPS</strong> to view the GPS location of the device on a map. You may check the <strong>Automatically adjust coordinates for GPS changes</strong> option if you want the system to automatically update the device coordinates.</p>
<p><img src="device_configuration/./assets/clip_image006-1604263959074.png" alt="img" /> </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-settings"><a class="header" href="#system-settings">System Settings</a></h1>
<h2 id="configuring-the-ip-addresses-of-interfaces"><a class="header" href="#configuring-the-ip-addresses-of-interfaces">Configuring the IP Addresses of Interfaces</a></h2>
<p>Go to <strong>System Settings &gt; IP Address</strong> to view and configure the IP addresses of the Ethernet and Wi-Fi interfaces. LAN1 can be configured both as a WAN and LAN interface. </p>
<p><img src="device_configuration/./assets/clip_image008-1604263959074.png" alt="img" /> </p>
<ul>
<li>LAN1 can be a WAN interface with the DHCP client enabled by default. </li>
<li>LAN2 uses static IP by default: 
<ul>
<li>IP Address : 192.168.4.127 </li>
<li>Subnet Mask: 255.255.255.0 </li>
</ul>
</li>
</ul>
<h2 id="configuring-cellular-settings"><a class="header" href="#configuring-cellular-settings">Configuring Cellular Settings</a></h2>
<p>Go to <strong>System Settings &gt; Cellular</strong> to view the current cellular settings. You can enable/disable cellular connectivity on your device, create profiles and manage <strong>Profile Settings</strong>, and enable/disable the connection <strong>Keep-alive</strong> function to optimize the cellular connection.</p>
<p><img src="device_configuration/./assets/clip_image010.png" alt="img" /> </p>
<p>You can create customized cellular profiles by choosing the <strong>Manual</strong> option in the <strong>Profile Settings</strong> section. A list of all the profiles in the system is displayed. <strong>Create</strong>, <strong>Edit</strong>, or <strong>Delete</strong> cellular profiles here.</p>
<p>To create a new cellular connection profile, do the following:</p>
<ol>
<li>Click <strong>+ CREATE</strong>.</li>
<li>Specify a unique <strong>Profile Name</strong>.</li>
<li>Specify the target <strong>SIM</strong> card.</li>
<li>Enter the <strong>PIN Code</strong>, if your SIM card requires it.
<strong>NOTE:</strong> Three wrong attempts will lock the SIM card.</li>
<li>Choose a <strong>Carrier</strong>. (<strong>NOTE:</strong> This option is displayed only if the cellular module supports carrier switching.)</li>
<li>Refer to instructions from your cellular carrier to select <strong>Static</strong> or <strong>Dynamic</strong> APN and configure the corresponding settings.</li>
</ol>
<p><img src="device_configuration/./assets/clip_image012.png" alt="img" /> </p>
<ol start="7">
<li>Click <strong>DONE</strong>.</li>
<li>On the <strong>Cellular</strong> setting page, click <strong>SAVE</strong>.</li>
</ol>
<p>When you click <strong>SAVE</strong> on the Cellular section, the module is restarted to apply the changes. The settings will take effect after the cellular module is successfully initialized. </p>
<p>The <strong>Keep-alive</strong> function will help you maintain the connection between your device and the carrier service by pinging a specific host on the Internet at periodic intervals. </p>
<p>In some circumstances, a system reboot might bring an unstable or malfunctioning device back to normal state. To enable automatic system reboot, select the <strong>Reboot the unit when ping to the target host failed continuously for a certain amount of time</strong> option and specify a reboot interval.</p>
<p><img src="device_configuration/./assets/clip_image014.png" alt="img" /> </p>
<p>Go to <strong>Network Overview &gt; WAN</strong> if you want to check the cellular network's connection status afterward.</p>
<p><img src="device_configuration/./assets/Network_Overview-Cellular_Connecting.PNG" alt="Network Overview :: WAN :: Cellular Status" /></p>
<h2 id="configuring-the-httphttps-service"><a class="header" href="#configuring-the-httphttps-service">Configuring the HTTP/HTTPS Service</a></h2>
<p>Go to <strong>System Settings &gt; HTTP/HTTPS</strong> to enable/ disable the HTTP and HTTPS service on ThingsPro Edge for specific ports. The default ports for HTTP and HTTPS are 80 and 8443 respectively. </p>
<p><img src="device_configuration/./assets/clip_image016.png" alt="img" /> </p>
<p>You can import a trusted SSL certificate (with private key) to ensure secure access to ThingsPro Edge. </p>
<h2 id="configuring-serial-ports"><a class="header" href="#configuring-serial-ports">Configuring Serial Ports</a></h2>
<p>Go to <strong>Systems Settings &gt; Serial</strong> to view all the serial ports, change the settings, and to clone a serial port. </p>
<p>To change the settings of a serial port, click the <img src="device_configuration/./assets/clip_image018.png" alt="img" /> icon. 
You can modify the <strong>Baud Rate</strong>, <strong>Parity</strong>, <strong>Data Bits</strong>, <strong>Stop Bits</strong>, and <strong>Flow Control</strong>, or specify an <strong>Alias</strong> and assign an interface. </p>
<p><img src="device_configuration/./assets/clip_image020.png" alt="img" /> </p>
<p>The settings of one serial port can be cloned and applied to other serial ports using <strong>SAVE &amp; CLONE</strong>. </p>
<p><img src="device_configuration/./assets/clip_image022.png" alt="img" /> </p>
<h2 id="configuring-the-dhcp-server"><a class="header" href="#configuring-the-dhcp-server">Configuring the DHCP Server</a></h2>
<p>Go to <strong>System Settings &gt; DHCP Server</strong> to view the DHCP settings. 
<strong>NOTE</strong> The DHCP service is only available on LAN and static IP interfaces.</p>
<p><img src="device_configuration/./assets/clip_image024.png" alt="img" /> </p>
<h2 id="configuring-wi-fi"><a class="header" href="#configuring-wi-fi">Configuring Wi-Fi</a></h2>
<p>Go to <strong>System Settings &gt; Wi-Fi</strong> to enable/disable the Wi-Fi interface for <strong>Client</strong> or <strong>AP</strong> mode.</p>
<p><img src="device_configuration/./assets/clip_image026.png" alt="img" /></p>
<p>To configure a Wi-Fi client, you need to connect to an access point (AP). To add an AP, click <strong>+ CREATE</strong> and select <strong>Create by SSID</strong> or <strong>Created by Scan Results</strong>.</p>
<p><img src="device_configuration/./assets/clip_image028.png" alt="img" /> <img src="device_configuration/./assets/clip_image030.png" alt="img" /> </p>
<p>The <strong>Check-alive</strong> function can be used to ensure Internet connectivity for the development. You can specify a target host and ping interval (sec). </p>
<p>To configure a Wi-Fi AP mode, do the following:</p>
<ol>
<li>Specify an <strong>SSID</strong>.
You can also choose to broadcast the SSID.</li>
<li>Specify a password for the connection.</li>
<li>Select a Wi-Fi band.</li>
<li>Select a region and channel.</li>
<li>Click <strong>SAVE</strong>.</li>
</ol>
<p><img src="device_configuration/./assets/clip_image032.png" alt="img" /></p>
<p>To configure Wi-Fi IP address, go to <strong>System Settings</strong> &gt; <strong>IP Address</strong> &gt; <strong>Wi-Fi</strong>. </p>
<p>To enable DHCP Server service for the Wi-Fi AP mode, go to <strong>System Settings</strong> &gt; <strong>DHCP Server</strong> &gt; <strong>Wi-Fi</strong>.</p>
<p>Go to <strong>Network Overview &gt; WAN</strong> to check the Wi-Fi network's connection status afterward.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="importingexporting-the-configuration-file"><a class="header" href="#importingexporting-the-configuration-file">Importing/Exporting the Configuration File</a></h1>
<p>Click <strong>General Operation &gt; Configuration</strong> to export/ import the gateway configuration file with a given password. The exported configuration file will be compressed to the <strong>tar.gz</strong> format and downloaded on to your computer. </p>
<p><img src="device_configuration/./assets/clip_image004-1604281744340.png" alt="img" /> </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exporting-the-system-log-file"><a class="header" href="#exporting-the-system-log-file">Exporting the System Log File</a></h1>
<p>Click <strong>System Log</strong> to export the system log file and specify the location to save the system logs.</p>
<p><img src="device_configuration/./assets/clip_image002-1604308944734.png" alt="img" /></p>
<p><img src="device_configuration/./assets/clip_image004-1604308944735.png" alt="img" /></p>
<p>To use the storage space effectively, you can <strong>Enable Time to Live</strong> and give the maximum space to store the system logs. </p>
<h1 id="viewing-event-logs"><a class="header" href="#viewing-event-logs">Viewing Event Logs</a></h1>
<p>Click <strong>Event Logs</strong> to view all event logs categorized by <strong>Severity</strong>, <strong>Event Name</strong>, and <strong>Category</strong>. You can use the <strong>SEARCH</strong> function to filter the Event logs to find a specific event. The Event Logs can be exported as a *.zip file and downloaded on to your computer.</p>
<p><img src="device_configuration/./assets/clip_image002-1604309047933.png" alt="img" /></p>
<h1 id="configuring-event-log-settings"><a class="header" href="#configuring-event-log-settings">Configuring Event Log Settings</a></h1>
<p>ThingsPro Edge allows you to choose the type of events to be stored, specify where to keep the logs, and the maximum storage size to use. Click the <strong>Event Settings</strong> to access these settings.</p>
<p><img src="device_configuration/./assets/Event_Logs-Event_Settings.png" alt="Event_Logs-Event_Settings" /></p>
<p>You can select the type of events to be stored by clicking on the different levels of the Severity: <strong>Alert</strong>, <strong>Warning</strong>, or <strong>Info</strong>. You can also select the individual event that you want to keep.</p>
<p><img src="device_configuration/./assets/Event_Logs-Event_Settings_UI.PNG" alt="Event_Logs-Event_Settings_UI" /></p>
<p>Click <img src="device_configuration/./assets/clip_image018-1604264036031.png" alt="img" /> to specify the location to store the event logs and the cache size (MB). Click <strong>SUBMIT</strong> to confirm your settings.</p>
<p><img src="device_configuration/./assets/Event_Logs-Event_Settings-Storage_Settings.PNG" alt="Event_Logs-Event_Settings-Storage_Settings" /></p>
<p>After all the settings are done, click <strong>SAVE</strong> to save and apply the settings.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-management"><a class="header" href="#user-management">User Management</a></h1>
<p>You can maintain ThingsPro Edge user accounts and assign a role with specific permissions to each account. These functions allow you to track and control who accesses this system via ThingsPro Edge Web GUI and API and manage the permissions.</p>
<h2 id="users"><a class="header" href="#users">Users</a></h2>
<p>You can <strong>View</strong>, <strong>Create</strong>, <strong>Edit</strong>, <strong>Deactivate</strong>, and <strong>Delete</strong> ThingsPro Edge user accounts. In the main menu, go to <strong>Security &gt; User Management &gt; Users</strong> to manage user accounts.</p>
<p><img src="security/./assets/Users-List.PNG" alt="Users-List" /></p>
<p><strong>Creating a New User Account</strong></p>
<p>Click on the <img src="security/./assets/Users-Create_Button.PNG" alt="Users-Create_Button" /> to create a new user account. In the dialogue box that is displayed, fill up the fields and click <strong>SUBMIT</strong>.</p>
<p><strong>NOTE:</strong> We recommend that you specify a strong password that is at least eight characters long consisting of at least one number and at least one special character.</p>
<table><thead><tr><th align="center">Password Policy</th><th align="center">Valid Password</th></tr></thead><tbody>
<tr><td align="center"><img src="security/./assets/Users-Create_New_Account.png" alt="Users-Create_New_Account" /></td><td align="center"><img src="security/./assets/Users-Create_New_Account-Good_Password.png" alt="Users-Create_New_Account-Good_Password" /></td></tr>
</tbody></table>
<p><strong>Managing Existing User Accounts</strong></p>
<p>To manage an account, click on the pop-up menu icon (<img src="security/./assets/PopUp_Menu_Icon.PNG" alt="PopUp_Menu_Icon" />) for the account.</p>
<p><img src="security/./assets/Users-Manage_Accounts.PNG" alt="Users-Manage_Accounts" /></p>
<table><thead><tr><th align="center">Function</th><th>Description</th></tr></thead><tbody>
<tr><td align="center">Edit</td><td>Change the role, email, or password of an existing account.</td></tr>
<tr><td align="center">Deactivate</td><td>Disallow the user from loggin in to ThingsPro Edge.</td></tr>
<tr><td align="center">Delete</td><td>Delete the user accouont. <strong>NOTE:</strong> This operation is irreversible.</td></tr>
</tbody></table>
<p><strong>NOTE:</strong> You cannot <strong>Deactivate</strong> or <strong>Delete</strong> the last remaining account with an Administrator role. This is to prevent  an unauthorized account from fully managing this system. When the system detects only one active account with the Administrator role is selected, all items in the pop-up menu will be greyed-out.</p>
<h2 id="user-roles"><a class="header" href="#user-roles">User Roles</a></h2>
<p>You can <strong>View</strong>, <strong>Create</strong>, <strong>Edit</strong>, and <strong>Delete</strong> user roles in ThingsPro Edge. In the main menu, go to <strong>Security &gt; User Management &gt; Roles</strong> to manage the user roles.</p>
<p><img src="security/./assets/Roles-List.PNG" alt="Roles-List" /></p>
<p>Click on the <img src="security/./assets/Roles-Create_Button.PNG" alt="Roles-Create_Button" /> to create a new user account. Specify a unique name to the role and assign appropriate permissions. When you are done, click on the button &quot;<strong>SUBMIT</strong>&quot; to create the role in the system.</p>
<p><img src="security/./assets/Roles-Create_New_Role.PNG" alt="Roles-Create_New_Role" /></p>
<p>You can <strong>Edit</strong> the settings or <strong>Delete</strong> an existing role by clicking on the pop-up menu icon (<img src="security/./assets/PopUp_Menu_Icon.PNG" alt="PopUp_Menu_Icon" />) next to the role.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="robust-ota-upgrade"><a class="header" href="#robust-ota-upgrade">Robust OTA Upgrade</a></h1>
<p><img src="security/./assets/ota-upgrade.jpg" alt="ota-upgrade" /></p>
<ul>
<li><strong>Download and install</strong>
<ul>
<li>Resume download from the last breakpoint</li>
<li>Redundant BIOS and Linux Kernel</li>
<li>Guaranteed download completion before starting the upgrade</li>
</ul>
</li>
<li><strong>Built-in security</strong>
<ul>
<li>Mutual X.509 certificate authentication between IIoT gateways and services</li>
<li>Encrypted communication between IIoT gateways and services</li>
</ul>
</li>
<li><strong>Manage from the Azure portal</strong>
<ul>
<li>Trigger OTA upgrade command from Azure IoT Hub</li>
<li>Continuous reporting of the upgrade progress to Azure IoT Hub.</li>
</ul>
</li>
<li><strong>Intelligence</strong>
<ul>
<li>Self-evaluation check before performing an upgrade process to ensure that the conditions permit an upgrade.</li>
<li>Auto rollback to the last wellpoint if an installation process failed. For example, an power outage. 
<strong>NOTE:</strong> For this feature, you must enable the &quot;take snapshot&quot; function, which is disabled by default. </li>
</ul>
</li>
</ul>
<h1 id="upgrading-the-thingspro-edge"><a class="header" href="#upgrading-the-thingspro-edge">Upgrading the ThingsPro Edge</a></h1>
<p>To upgrade the ThingsPro Edge with Moxa's software packages, click <strong>General Operation &gt; Software Upgrade</strong>. There are two ways to upgrade ThingsPro Edge: <strong>Upgrade from the local drive</strong> or <strong>Download it over-the-air</strong>.</p>
<ul>
<li>
<p><strong>Upgrade from the local driver</strong></p>
<p>Select the software package file in *.deb file format on your computer.</p>
</li>
<li>
<p><strong>Download it over-the-air</strong></p>
<p>Specify the URL for your repository or trusted source to download the software packages (*.yaml) from. </p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="eligible-devices"><a class="header" href="#eligible-devices">Eligible Devices</a></h1>
<table><thead><tr><th>Series</th><th>Model</th><th>Revision</th><th>Firmware Version</th><th></th></tr></thead><tbody>
<tr><td>AIG-300</td><td>AIG-301-US-AZU-LX</td><td>1.0.0</td><td>1.1</td><td></td></tr>
<tr><td></td><td>AIG-301-EU-AZU-LX</td><td>1.0.0</td><td>1.1</td><td></td></tr>
<tr><td></td><td>AIG-301-AP-AZU-LX</td><td>1.0.0</td><td>1.1</td><td></td></tr>
<tr><td></td><td>AIG-301-CN-AZU-LX</td><td>1.0.0</td><td>1.1</td><td></td></tr>
<tr><td></td><td>AIG-301-AZU-LX</td><td>1.0.0</td><td>1.1</td><td></td></tr>
<tr><td>UC-8200</td><td>UC-8210-T-LX</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td></td><td>UC-8210-T-LX-S</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td></td><td>UC-8220-T-LX</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td></td><td>UC-8220-T-LX-US-S</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td></td><td>UC-8220-T-LX-EU-S</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td></td><td>UC-8220-T-LX-AP-S</td><td>1.0.0/1.0.1</td><td>1.3</td><td></td></tr>
<tr><td>UC-8100A-ME-T</td><td>UC-8112A-ME-T-LX</td><td>1.0.2/1.0.3</td><td>1.5</td><td></td></tr>
<tr><td></td><td>UC-8112A-ME-T-LX-AP</td><td>1.0.2/1.0.3</td><td>1.5</td><td></td></tr>
<tr><td></td><td>UC-8112A-ME-T-LX-US</td><td>1.0.2/1.0.3</td><td>1.5</td><td></td></tr>
<tr><td></td><td>UC-8112A-ME-T-LX-EU</td><td>1.0.2/1.0.3</td><td>1.5</td><td></td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="software-development"><a class="header" href="#software-development">Software Development</a></h1>
<p>ThingsPro Edge offers rich RESTful APIs to help SI/ISVs leverage or integrate many of the capabilities to simplify solution development. Please refer to the online document for the list of Open API and the instruction of thingspro-agent utility.</p>
<ul>
<li>ThingsPro Edge v2.2.0 Open API: https://thingspro-edge.moxa.online/v2.2.0/core/index.html</li>
<li>ThingsPro Edge v2.2.0 Azure IoT Edge document: https://thingspro-edge.moxa.online/v2.2.0/thingspro-agent/index.html</li>
</ul>
<h1 id="linux-development-note"><a class="header" href="#linux-development-note">Linux Development Note</a></h1>
<p>If the developers want to add the missing features or extend the functions provided by ThingsPro Edge, the developers can log in to the computer and run their programs.</p>
<p>ThingsPro Edge provides general settings, network configuration, and so on. Hence, the developers need to pay attention to this notice to avoid using some system operations and commands to unstable the system.</p>
<p>Linux development is not recommended in the field in the production environment. Please do develop and test in the lab to reach the device before going to production.</p>
<h2 id="things-must-be-avoided"><a class="header" href="#things-must-be-avoided">Things MUST be avoided</a></h2>
<p>Items listed in the section usually managed by ThingsPro Edge. You may able to modify the configuration for a while then get reverted.</p>
<ul>
<li>Networking: IP Settings, Routing, Ethernet, Wi-Fi, Cellular, including commands such as <code>ip</code>, <code>dhclient</code>, <code>dhcpd</code>, <code>route</code>, <code>iw</code>, <code>hostapd</code>, <code>wpa_supplicant</code>, <code>cell_mgmt</code></li>
<li>LED control: <code>mx-led-ctl</code></li>
<li>Serial: <code>mx-uart-ctl</code></li>
<li>Time: <code>timedatectl</code>, <code>ntpd</code></li>
<li>SD card: Auto-mounted configuration</li>
<li>Snapshot: <code>mx-snapshot-ctl</code>, <code>mx-system-ctl</code></li>
</ul>
<h2 id="things-could-be-done-with-caution"><a class="header" href="#things-could-be-done-with-caution">Things COULD be done with caution</a></h2>
<p>Items listed in the section are not managed by ThingsPro Edge. Please modify carefully in case of breaking ThingsPro Edge.</p>
<ul>
<li>
<p>Networking: <code>iptables</code> (Don't modify the MOXA-* CHAINS, everything else should be ok)</p>
</li>
<li>
<p>Package Management: </p>
<pre><code>apt-get
</code></pre>
<p>(Read the warning messages carefully every time before install/upgrade/remove packages)</p>
<ul>
<li>By default, ThingsPro Edge comments out all the sources in the source list (<code>/etc/apt/sources.list</code>)</li>
</ul>
</li>
</ul>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<ol>
<li>
<p>Web Server is bound to the following: </p>
<ul>
<li>HTTP : 80 port</li>
<li>HTTPS : 8443 port </li>
</ul>
</li>
<li>
<p>SSH Server is bound to port 22 but disabled by default. You can turn it via the Web UI or Restful API.</p>
</li>
<li>
<p>ICMP protocol is disabled by default.</p>
</li>
<li>
<p>All containers' logs are integrated into the Linux journal service. You can monitor the Azure IoT Edge containers' logs using the following commands.</p>
<pre><code>journalctl CONTAINER_NAME=edgeAgent -f
journalctl CONTAINER_NAME=edgeHub -f
journalctl CONTAINER_NAME=thingspro-agent -f
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="known-issues--limitations"><a class="header" href="#known-issues--limitations">Known Issues &amp; Limitations</a></h1>
<ol>
<li>
<p>Wi-Fi Client scanning function only works when in Wi-Fi Client mode. If you are switching the mode from AP to Client, save the configuration before clicking the SCAN button.</p>
</li>
<li>
<p>In the Wi-Fi Client mode, you might not be able to see all the status changes if there are more than two AP profiles in the AP list.</p>
</li>
<li>
<p>The &quot;Go to edit&quot; link is displayed in *<em>Network Overview</em> even when the user doesn't have permissions.</p>
</li>
<li>
<p>macOS users can't login to Web GUI via Wi-Fi interfaces.</p>
</li>
<li>
<p>When the IP is changed, the certificate for HTTPS will be re-generated. As a result, users will be required to refresh their browser and bypass the certificate warning message again.</p>
</li>
<li>
<p>Web GUI: Auto logout function does not work properly if users use Web GUI via IPv6.</p>
</li>
<li>
<p>Modbus Master: RTU doesn't support baud rate &lt; 9600.</p>
</li>
<li>
<p>Dashboard: <strong>Network Overview</strong> won't be available for a while after the mode is changed to Wi-Fi.</p>
</li>
<li>
<p>Dashboard: Hitting the refresh button will always select the first interface instead of the current selection.</p>
</li>
<li>
<p>Modbus Master: If a command on the device fails, the device will go offline.</p>
</li>
<li>
<p>Web GUI: When a system clock skew is detected (criteria: over 5 minutes), the backend API calls will always return status code 504 and the API session authentication expiration function will not work properly (the later one will only happen if the system time is changed to a time that is in the past). The issue can be fixed by refreshing the web page and rebooting the device.</p>
</li>
<li>
<p>Dashboard: Wi-Fi interface will be shown as 2 entries &quot;Wi-Fi (Wi-Fi1)&quot; &amp; &quot;Ethernet(Wi-Fi1)&quot;</p>
</li>
<li>
<p>ThingsPro Proxy: Only supports LAN1; Wi-Fi client needs to be disabled.</p>
</li>
<li>
<p>Azure IoT Edge: Every hour the edge agent will re-establish the connection for renewing the authentication information. Users can ignore the connect/disconnect entries in the event log.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h3 id="modbus-master-specification"><a class="header" href="#modbus-master-specification">Modbus Master Specification</a></h3>
<p><strong>Protocol</strong></p>
<ul>
<li>TCP</li>
<li>Serial Port : RTU / ASCII</li>
</ul>
<p><strong>Function Call</strong></p>
<ul>
<li>01 Read Coils</li>
<li>02 Read Discrete Inputs</li>
<li>03 Read Holding Registers</li>
<li>04 Read Input Registers</li>
<li>05 Write Single Coil</li>
<li>06 Write Single Register</li>
<li>15 Write Multiple Coils</li>
<li>16 Write Multiple Registers</li>
<li>23 Read/Write Multiple Registers</li>
</ul>
<p><strong>Data Trigger by</strong></p>
<ul>
<li>Cyclic / Data Change</li>
</ul>
<p><strong>Endian Swap</strong></p>
<ul>
<li>None / Byte / Word / Byte and Word</li>
</ul>
<p><strong>Data Scaling</strong> </p>
<ul>
<li>None / Slop-intercept / Point-slope</li>
</ul>
<p><strong>Tag Data Type</strong></p>
<ul>
<li>raw / boolean / int16 / int32 / int64 / uint16 / uint32 / uint64 / float / double / string</li>
</ul>
<h5 id="web-ui--restful-api-and-remote-management"><a class="header" href="#web-ui--restful-api-and-remote-management">Web UI,  RESTful API and Remote Management</a></h5>
<p>Modbus Master application allows you to manage settings in variable ways.</p>
<table><thead><tr><th>Feature</th><th align="center">Web GUI</th><th align="center">RESTful API</th><th align="center">Azure Direct Method</th><th align="center">MQTT Topic</th></tr></thead><tbody>
<tr><td>Start/Stop Modbus Master App</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Create slave device - TCP / Serial</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Enable/Disable slave device</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Setting TCP slave device parameters</td><td align="center"></td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Setting Serial slave device parameters</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Delete slave device</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Create command by function call</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Create tag associated with command</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Apply endian swap on tag data</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Apply data scaling on tag data</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Update/Delete command</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Update data trigger mode</td><td align="center"></td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Import/Export commands as CSV file</td><td align="center">O</td><td align="center">O</td><td align="center"></td><td align="center"></td></tr>
<tr><td>Import/Export Modbus configuration as CSV file</td><td align="center">O</td><td align="center">O</td><td align="center"></td><td align="center"></td></tr>
<tr><td>Enable/Disable slave device fail event</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
<tr><td>Enable/Disable function call fail event</td><td align="center">O</td><td align="center">O</td><td align="center">O</td><td align="center">O</td></tr>
</tbody></table>
<p>Please refer to <font color='blue'>ThingsPro Edge V2.0.0 Restful API</font></p>
<h5 id="limitation-and-constrain-on-device-uc-8112a-me"><a class="header" href="#limitation-and-constrain-on-device-uc-8112a-me">limitation and constrain on device UC-8112A-ME</a></h5>
<table><thead><tr><th>Item</th><th>Max Value</th><th>Note</th></tr></thead><tbody>
<tr><td>Max Serial Slave Device #</td><td>31</td><td>Able to create max 31 serial slave device.</td></tr>
<tr><td>Max TCP Slave Device #</td><td>32</td><td>Able to create max 32 TCP slave device.</td></tr>
<tr><td>Max Command #</td><td>2048</td><td>Support max 2048 commands across all slave devices.</td></tr>
<tr><td>Max Tag #</td><td>2048</td><td>Support max 2048 tags across all commands.</td></tr>
<tr><td>Max Command # in a Serial Port</td><td>128</td><td>Support max 128 commands for a serial slave device.</td></tr>
<tr><td>Max Command # in a TCP Port</td><td>2048</td><td>Support max 2048 commands for a TCP slave device.</td></tr>
</tbody></table>
<p>Modbus Master application support big integer range is:</p>
<table><thead><tr><th>Data Type</th><th>Min</th><th>Max</th></tr></thead><tbody>
<tr><td>Int64</td><td>-922337203685477</td><td>922337203685477</td></tr>
<tr><td>Unsigned int64</td><td>0</td><td>1,844,674,407,370,954</td></tr>
</tbody></table>
<h5 id="performance-benchmark-on-device-uc-8112a-me"><a class="header" href="#performance-benchmark-on-device-uc-8112a-me">Performance benchmark on device UC-8112A-ME.</a></h5>
<p>Environments:</p>
<ul>
<li>Running period: 15 minutes</li>
<li>Slave device: one TCP slave device, two serial slave devices</li>
<li>Others application: No</li>
</ul>
<table><thead><tr><th>Tags #</th><th>Polling Interval (ms)</th><th>1 mins</th><th>5 mins</th><th>15 mins</th></tr></thead><tbody>
<tr><td>50</td><td>1000</td><td>0.58</td><td>0.53</td><td>0.48</td></tr>
<tr><td>100</td><td>1000</td><td>0.81</td><td>0.77</td><td>0.62</td></tr>
<tr><td>150</td><td>1000</td><td>0.58</td><td>0.54</td><td>0.55</td></tr>
<tr><td>200</td><td>1000</td><td>0.77</td><td>0.92</td><td>0.8</td></tr>
<tr><td>250</td><td>1000</td><td>0.83</td><td>0.82</td><td>0.85</td></tr>
<tr><td>300</td><td>1000</td><td>2.03</td><td>1.39</td><td>1.13</td></tr>
</tbody></table>
<p>The result represents: the UC-8112A-ME gateway device is capable of fetching 250 tags per second over the Modbus protocol.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="ota-software-upgrade"><a class="header" href="#ota-software-upgrade">OTA Software Upgrade</a></h3>
<p><img src="https://ThingsPro.azureedge.net/resource/document/release-notes/ota-upgrade.jpg" alt="ThingsPro Edge Robust OTA Software Upgrade Features" /></p>
<h5 id="download-and-installation-process"><a class="header" href="#download-and-installation-process">Download and installation process</a></h5>
<ul>
<li>
<p>Resume download from the last breakpoint</p>
</li>
<li>
<p>Redundant BIOS and Linux Kernel</p>
</li>
<li>
<p>Guaranty download completed before the upgrade</p>
</li>
</ul>
<h5 id="security"><a class="header" href="#security">Security</a></h5>
<ul>
<li>Mutual X.509 cert. authentication between IIoT Gateway devices and Server</li>
<li>Encrypted communicate between IIoT Gateway devices and Server</li>
</ul>
<h5 id="management"><a class="header" href="#management">Management</a></h5>
<ul>
<li>Trigger OTA upgrade command from Azure IoT Hub</li>
<li>Continue report upgrade process status to Azure IoT Hub</li>
</ul>
<h5 id="intelligence"><a class="header" href="#intelligence">Intelligence</a></h5>
<ul>
<li>Self-evaluated to execute the upgrade process under capable conditions only. </li>
<li>Auto roll-back to last well point if fail. (<font color='red'><b>Note: this feature requires to enable &quot;take snapshot&quot; via RESTful AP, and it be disable by default.</b></font> )</li>
</ul>
<h5 id="benchmark"><a class="header" href="#benchmark">Benchmark</a></h5>
<ul>
<li><strong>Software upgrade with snapshot</strong></li>
</ul>
<table><thead><tr><th>Step</th><th>Task</th><th>Duration</th></tr></thead><tbody>
<tr><td>1</td><td>Download Software</td><td>depend on network bandwidth</td></tr>
<tr><td>2</td><td>Take snapshot</td><td>~13 min</td></tr>
<tr><td>3</td><td>Installation</td><td>~15 min</td></tr>
<tr><td>4</td><td>Restart</td><td>~2 min</td></tr>
<tr><td></td><td><font color='blue'><b>Total</b></font></td><td><font color='blue'><b>~30 min</b></font></td></tr>
</tbody></table>
<ul>
<li><strong>Software upgrade without snapshot</strong></li>
</ul>
<table><thead><tr><th>Step</th><th>Task</th><th>Duration</th></tr></thead><tbody>
<tr><td>1</td><td>Download Software</td><td>depend on network bandwidth</td></tr>
<tr><td>2</td><td>Installation</td><td>~13 min</td></tr>
<tr><td>3</td><td>Restart</td><td>~2 min</td></tr>
<tr><td></td><td><font color='blue'><b>Total</b></font></td><td><font color='blue'><b>~15 min</b></font></td></tr>
</tbody></table>
<ul>
<li><strong>Roll back from snapshot if fail</strong></li>
</ul>
<table><thead><tr><th>Step</th><th>Task</th><th>Duration</th></tr></thead><tbody>
<tr><td>1</td><td>Roll Back</td><td>~ 5 min</td></tr>
<tr><td>2</td><td>Restart</td><td>~2 min</td></tr>
<tr><td></td><td><font color='blue'><b>Total</b></font></td><td></td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
